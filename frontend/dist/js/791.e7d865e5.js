"use strict";(self["webpackChunktcr_system_frontend"]=self["webpackChunktcr_system_frontend"]||[]).push([[791],{791:function(e,a,s){s.r(a),s.d(a,{default:function(){return q}});var t=s(6768),l=s(4232),o=s(144),r=s(5130),n=s(7477),c=s(1219),u=s(2933),d=s(788),i=s.n(d),k=s(1387),p=s(1576),m=s.n(p);const g={class:"courses-container"},v={key:0,class:"empty-block"},_={class:"course-header"},b={class:"course-name"},f={class:"course-content"},F={class:"course-description"},h={class:"course-teacher"},y={class:"course-time"},L={class:"course-location"},C={class:"course-end-time"},W={class:"course-end-form"},R={key:0,class:"course-end-location"},w={class:"course-footer"},X={class:"card-header"},z={key:0,class:"empty-block"},E={class:"course-header"},K={class:"course-name"},S={class:"course-content"},N={class:"course-description"},T={class:"course-teacher"},I={class:"course-time"},V={class:"course-location"},x={class:"course-end-time"},B={class:"course-end-form"},D={key:0,class:"course-end-location"},Y={class:"course-footer"},$={class:"pagination-container"};var A={__name:"Courses",setup(e){const a=(0,k.rd)(),s=(0,o.KR)(!1),d=(0,o.KR)("myCourses"),p=(0,o.KR)([]),A=(0,o.KR)([]),M=(0,o.KR)(0),j=(0,o.KR)(""),q=(0,o.Kh)({pageNum:1,pageSize:8,name:"",status:1}),H=(0,t.EW)({get:()=>q.pageNum,set:e=>{q.pageNum=e}}),Q=(0,t.EW)({get:()=>q.pageSize,set:e=>{q.pageSize=e}}),U=e=>e?m()(e).format("YYYY-MM-DD HH:mm"):"未设置",G=e=>{switch(e){case 0:return"考试";case 1:return"大作业";default:return"未设置"}},J=async()=>{s.value=!0;try{console.log("开始获取我的课程列表...");const e=localStorage.getItem("token");console.log("当前token:",e);const a=await i().get("/api/student/courses",{headers:{Authorization:`Bearer ${e}`}});console.log("获取我的课程列表成功:",a.data),200===a.data.code?(p.value=a.data.data||[],console.log("我的课程数量:",p.value.length)):(console.error("获取我的课程列表失败:",a.data.message),c.nk.error(a.data.message||"获取我的课程列表失败"))}catch(e){console.error("获取我的课程列表失败:",e),e.response&&(console.error("错误状态码:",e.response.status),console.error("错误数据:",e.response.data)),c.nk.error("获取我的课程列表失败: "+(e.response?.data?.message||e.message))}finally{s.value=!1}},O=async()=>{s.value=!0;try{console.log("开始获取可选课程列表...");const e=localStorage.getItem("token");console.log("当前token:",e);const a=await i().get("/api/course/list",{params:q,headers:{Authorization:`Bearer ${e}`}});if(console.log("获取可选课程列表成功:",a.data),200===a.data.code){if(A.value=a.data.data.records||[],M.value=a.data.data.total||0,p.value.length>0){const e=p.value.map((e=>e.id));A.value=A.value.filter((a=>!e.includes(a.id)))}console.log("可选课程数量:",A.value.length)}else console.error("获取可选课程列表失败:",a.data.message),c.nk.error(a.data.message||"获取可选课程列表失败")}catch(e){console.error("获取可选课程列表失败:",e),e.response&&(console.error("错误状态码:",e.response.status),console.error("错误数据:",e.response.data)),c.nk.error("获取可选课程列表失败: "+(e.response?.data?.message||e.message))}finally{s.value=!1}},P=()=>{q.name=j.value,q.pageNum=1,O()},Z=async e=>{try{const a=await i().post(`/api/student/course/select/${e}`);200===a.data.code?(c.nk.success("选课成功"),J(),O()):c.nk.error(a.data.message||"选课失败")}catch(a){console.error("选课失败:",a),c.nk.error("选课失败")}},ee=async e=>{u.s.confirm("确定要退选该课程吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{const a=await i().post(`/api/student/course/drop/${e}`);200===a.data.code?(c.nk.success("退选成功"),J(),O()):c.nk.error(a.data.message||"退选失败")}catch(a){console.error("退选失败:",a),c.nk.error("退选失败")}})).catch((()=>{}))},ae=e=>{a.push({name:"StudentMaterials",query:{courseId:e}})},se=e=>{a.push({name:"StudentFeedback",query:{courseId:e}})},te=e=>{q.pageNum=e,O()},le=e=>{q.pageSize=e,O()},oe=e=>{switch(e){case 0:return"danger";case 1:return"success";case 2:return"info";default:return""}},re=e=>{switch(e){case 0:return"已关闭";case 1:return"正常";case 2:return"已结束";default:return"未知"}};return(0,t.sV)((()=>{J(),O()})),(e,a)=>{const c=(0,t.g2)("el-empty"),u=(0,t.g2)("el-tag"),i=(0,t.g2)("el-icon"),k=(0,t.g2)("el-button"),m=(0,t.g2)("el-card"),q=(0,t.g2)("el-col"),J=(0,t.g2)("el-row"),ne=(0,t.g2)("el-tab-pane"),ce=(0,t.g2)("el-input"),ue=(0,t.g2)("el-pagination"),de=(0,t.g2)("el-tabs"),ie=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",g,[a[8]||(a[8]=(0,t.Lk)("h1",null,"课程选择",-1)),(0,t.bF)(de,{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=e=>d.value=e),type:"card"},{default:(0,t.k6)((()=>[(0,t.bF)(ne,{label:"我的课程",name:"myCourses"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{class:"course-list-card"},{header:(0,t.k6)((()=>a[2]||(a[2]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("span",null,"已选课程")],-1)]))),default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.CE)("div",null,[0===p.value.length?((0,t.uX)(),(0,t.CE)("div",v,[(0,t.bF)(c,{description:"暂无已选课程"})])):((0,t.uX)(),(0,t.Wv)(J,{key:1,gutter:20},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(p.value,(e=>((0,t.uX)(),(0,t.Wv)(q,{xs:24,sm:12,md:8,lg:6,key:e.id},{default:(0,t.k6)((()=>[(0,t.bF)(m,{class:"course-card",shadow:"hover"},{header:(0,t.k6)((()=>[(0,t.Lk)("div",_,[(0,t.Lk)("span",b,(0,l.v_)(e.name),1),(0,t.bF)(u,{type:oe(e.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,l.v_)(re(e.status)),1)])),_:2},1032,["type"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",f,[(0,t.Lk)("p",F,(0,l.v_)(e.description||"暂无描述"),1),(0,t.Lk)("p",h,"教师: "+(0,l.v_)(e.teacherName||"未知"),1),(0,t.Lk)("p",y,[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(n.Calendar))])),_:1}),(0,t.eW)(" 上课时间: "+(0,l.v_)(e.classTime||"未设置"),1)]),(0,t.Lk)("p",L,[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(n.Location))])),_:1}),(0,t.eW)(" 上课地点: "+(0,l.v_)(e.classLocation||"未设置"),1)]),(0,t.Lk)("p",C,[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(n.Timer))])),_:1}),(0,t.eW)(" 结课时间: "+(0,l.v_)(U(e.endTime)),1)]),(0,t.Lk)("p",W,[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(n.Document))])),_:1}),(0,t.eW)(" 结课形式: "+(0,l.v_)(G(e.endForm)),1)]),0===e.endForm?((0,t.uX)(),(0,t.CE)("p",R,[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(n.Location))])),_:1}),(0,t.eW)(" 考试地点: "+(0,l.v_)(e.endLocation||"未设置"),1)])):(0,t.Q3)("",!0)]),(0,t.Lk)("div",w,[(0,t.bF)(k,{type:"primary",onClick:a=>ae(e.id)},{default:(0,t.k6)((()=>a[3]||(a[3]=[(0,t.eW)("查看资料")]))),_:2},1032,["onClick"]),(0,t.bF)(k,{type:"info",onClick:a=>se(e.id)},{default:(0,t.k6)((()=>a[4]||(a[4]=[(0,t.eW)("课程反馈")]))),_:2},1032,["onClick"]),(0,t.bF)(k,{type:"danger",onClick:a=>ee(e.id)},{default:(0,t.k6)((()=>a[5]||(a[5]=[(0,t.eW)("退选课程")]))),_:2},1032,["onClick"])])])),_:2},1024)])),_:2},1024)))),128))])),_:1}))])),[[ie,s.value]])])),_:1})])),_:1}),(0,t.bF)(ne,{label:"可选课程",name:"availableCourses"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{class:"course-list-card"},{header:(0,t.k6)((()=>[(0,t.Lk)("div",X,[a[6]||(a[6]=(0,t.Lk)("span",null,"可选课程",-1)),(0,t.bF)(ce,{modelValue:j.value,"onUpdate:modelValue":a[0]||(a[0]=e=>j.value=e),placeholder:"搜索课程名称",style:{width:"200px"},clearable:"",onClear:O,onKeyup:(0,r.jR)(P,["enter"])},{append:(0,t.k6)((()=>[(0,t.bF)(k,{onClick:P},{default:(0,t.k6)((()=>[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(n.Search))])),_:1})])),_:1})])),_:1},8,["modelValue"])])])),default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.CE)("div",null,[0===A.value.length?((0,t.uX)(),(0,t.CE)("div",z,[(0,t.bF)(c,{description:"暂无可选课程"})])):((0,t.uX)(),(0,t.Wv)(J,{key:1,gutter:20},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(A.value,(e=>((0,t.uX)(),(0,t.Wv)(q,{xs:24,sm:12,md:8,lg:6,key:e.id},{default:(0,t.k6)((()=>[(0,t.bF)(m,{class:"course-card",shadow:"hover"},{header:(0,t.k6)((()=>[(0,t.Lk)("div",E,[(0,t.Lk)("span",K,(0,l.v_)(e.name),1),(0,t.bF)(u,{type:oe(e.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,l.v_)(re(e.status)),1)])),_:2},1032,["type"])])])),default:(0,t.k6)((()=>[(0,t.Lk)("div",S,[(0,t.Lk)("p",N,(0,l.v_)(e.description||"暂无描述"),1),(0,t.Lk)("p",T,"教师: "+(0,l.v_)(e.teacherName||"未知"),1),(0,t.Lk)("p",I,[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(n.Calendar))])),_:1}),(0,t.eW)(" 上课时间: "+(0,l.v_)(e.classTime||"未设置"),1)]),(0,t.Lk)("p",V,[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(n.Location))])),_:1}),(0,t.eW)(" 上课地点: "+(0,l.v_)(e.classLocation||"未设置"),1)]),(0,t.Lk)("p",x,[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(n.Timer))])),_:1}),(0,t.eW)(" 结课时间: "+(0,l.v_)(U(e.endTime)),1)]),(0,t.Lk)("p",B,[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(n.Document))])),_:1}),(0,t.eW)(" 结课形式: "+(0,l.v_)(G(e.endForm)),1)]),0===e.endForm?((0,t.uX)(),(0,t.CE)("p",D,[(0,t.bF)(i,null,{default:(0,t.k6)((()=>[(0,t.bF)((0,o.R1)(n.Location))])),_:1}),(0,t.eW)(" 考试地点: "+(0,l.v_)(e.endLocation||"未设置"),1)])):(0,t.Q3)("",!0)]),(0,t.Lk)("div",Y,[(0,t.bF)(k,{type:"primary",onClick:a=>Z(e.id)},{default:(0,t.k6)((()=>a[7]||(a[7]=[(0,t.eW)("选择课程")]))),_:2},1032,["onClick"])])])),_:2},1024)])),_:2},1024)))),128))])),_:1})),(0,t.Lk)("div",$,[(0,t.bF)(ue,{"current-page":H.value,"page-size":Q.value,"page-sizes":[8,16,24,32],layout:"total, sizes, prev, pager, next, jumper",total:M.value,onSizeChange:le,onCurrentChange:te},null,8,["current-page","page-size","total"])])])),[[ie,s.value]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}}},M=s(1241);const j=(0,M.A)(A,[["__scopeId","data-v-ad3e14a8"]]);var q=j}}]);
//# sourceMappingURL=791.e7d865e5.js.map