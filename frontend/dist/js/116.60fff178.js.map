{"version":3,"file":"js/116.60fff178.js","mappings":"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","sources":["webpack://tcr-system-frontend/./src/views/teacher/Home.vue","webpack://tcr-system-frontend/./src/views/teacher/Home.vue?b817"],"sourcesContent":["<template>\n  <div class=\"teacher-home\">\n    <div class=\"welcome-section\">\n      <el-row :gutter=\"20\">\n        <el-col :span=\"16\">\n          <el-card class=\"welcome-card\" shadow=\"hover\">\n            <div class=\"welcome-content\">\n              <div class=\"welcome-text\">\n        <h2>欢迎回来，{{ userInfo?.realName || '老师' }}</h2>\n                <p class=\"subtitle\">今天是 {{ currentDate }}，祝您工作愉快！</p>\n                <p class=\"description\">您可以在这里上传教学材料并提交审核，查看审核进度和结果。</p>\n              </div>\n              <div class=\"welcome-image\">\n                <img src=\"https://img.icons8.com/color/240/000000/teacher.png\" alt=\"教师图标\">\n              </div>\n            </div>\n          </el-card>\n        </el-col>\n        <el-col :span=\"8\">\n          <el-card class=\"quick-stats\" shadow=\"hover\">\n            <template #header>\n              <div class=\"card-header\">\n                <span>数据概览</span>\n              </div>\n            </template>\n            <div class=\"stats-content\">\n              <div class=\"stat-item\">\n                <div class=\"stat-icon upload\">\n                  <el-icon><Upload /></el-icon>\n                </div>\n                <div class=\"stat-info\">\n                  <div class=\"stat-value\">{{ uploadCount }}</div>\n                  <div class=\"stat-label\">已上传材料</div>\n                </div>\n              </div>\n              <div class=\"stat-item\">\n                <div class=\"stat-icon review\">\n                  <el-icon><Document /></el-icon>\n                </div>\n                <div class=\"stat-info\">\n                  <div class=\"stat-value\">{{ reviewCount }}</div>\n                  <div class=\"stat-label\">审核中材料</div>\n                </div>\n              </div>\n            </div>\n          </el-card>\n        </el-col>\n      </el-row>\n    </div>\n    \n    <div class=\"quick-actions\">\n      <el-row :gutter=\"20\">\n        <el-col :span=\"8\" v-for=\"(action, index) in quickActions\" :key=\"index\">\n          <el-card class=\"action-card\" shadow=\"hover\" @click=\"navigateTo(action.path)\">\n            <div class=\"action-content\">\n              <div class=\"action-icon\" :class=\"action.iconClass\">\n                <el-icon><component :is=\"action.icon\" /></el-icon>\n              </div>\n              <div class=\"action-text\">\n                <h3>{{ action.title }}</h3>\n                <p>{{ action.description }}</p>\n              </div>\n      </div>\n    </el-card>\n        </el-col>\n      </el-row>\n    </div>\n    \n    <div class=\"recent-section\">\n      <el-row :gutter=\"20\">\n      <el-col :span=\"12\">\n          <el-card shadow=\"hover\">\n          <template #header>\n            <div class=\"card-header\">\n                <span>最近上传的材料</span>\n                <el-button type=\"primary\" text @click=\"navigateTo('/teacher/material-upload')\">查看全部</el-button>\n            </div>\n          </template>\n            <div v-if=\"recentMaterials.length > 0\">\n              <el-table :data=\"recentMaterials\" style=\"width: 100%\">\n                <el-table-column prop=\"name\" label=\"材料名称\" width=\"180\"></el-table-column>\n                <el-table-column prop=\"course_name\" label=\"所属课程\"></el-table-column>\n                <el-table-column prop=\"create_time\" label=\"上传时间\" width=\"180\"></el-table-column>\n              </el-table>\n          </div>\n            <el-empty v-else description=\"暂无上传记录\"></el-empty>\n        </el-card>\n      </el-col>\n      <el-col :span=\"12\">\n          <el-card shadow=\"hover\">\n          <template #header>\n            <div class=\"card-header\">\n                <span>待审核的材料</span>\n                <el-button type=\"primary\" text @click=\"navigateTo('/teacher/material-review')\">查看全部</el-button>\n            </div>\n          </template>\n            <div v-if=\"pendingReviews.length > 0\">\n              <el-table :data=\"pendingReviews\" style=\"width: 100%\">\n                <el-table-column prop=\"material_name\" label=\"材料名称\" width=\"180\"></el-table-column>\n                <el-table-column prop=\"status\" label=\"状态\">\n                  <template #default=\"scope\">\n                    <el-tag :type=\"getStatusType(scope.row.status)\">{{ getStatusText(scope.row.status) }}</el-tag>\n                  </template>\n                </el-table-column>\n                <el-table-column prop=\"current_reviewer_name\" label=\"当前审核人\"></el-table-column>\n              </el-table>\n          </div>\n            <el-empty v-else description=\"暂无待审核材料\"></el-empty>\n        </el-card>\n      </el-col>\n    </el-row>\n    </div>\n    \n    <!-- 教学材料任务通知 -->\n    <div class=\"tasks-section\">\n      <el-card shadow=\"hover\">\n        <template #header>\n          <div class=\"card-header\">\n            <span>教学材料任务</span>\n            <el-badge :value=\"uncompletedTasksCount\" :hidden=\"uncompletedTasksCount === 0\" type=\"warning\">\n              <el-tag type=\"warning\" v-if=\"uncompletedTasksCount > 0\">有 {{ uncompletedTasksCount }} 个任务待完成</el-tag>\n            </el-badge>\n          </div>\n        </template>\n        <div v-if=\"materialTasks.length > 0\">\n          <el-table :data=\"materialTasks\" style=\"width: 100%\">\n            <el-table-column prop=\"title\" label=\"任务标题\" width=\"250\"></el-table-column>\n            <el-table-column prop=\"materialTypeName\" label=\"材料类型\" width=\"120\"></el-table-column>\n            <el-table-column prop=\"courseName\" label=\"课程\" width=\"180\"></el-table-column>\n            <el-table-column prop=\"deadline\" label=\"截止日期\" width=\"180\"></el-table-column>\n            <el-table-column label=\"状态\" width=\"100\">\n              <template #default=\"scope\">\n                <el-tag \n                  :type=\"scope.row.completed ? 'success' : (isTaskExpired(scope.row.deadline) ? 'danger' : 'warning')\"\n                >\n                  {{ scope.row.completed ? '已完成' : (isTaskExpired(scope.row.deadline) ? '已过期' : '未完成') }}\n                </el-tag>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"操作\">\n              <template #default=\"scope\">\n                <el-button \n                  v-if=\"!scope.row.completed\" \n                  type=\"primary\" \n                  size=\"small\" \n                  @click=\"handleUploadForTask(scope.row)\"\n                >\n                  上传材料\n                </el-button>\n                <el-button \n                  v-else \n                  type=\"success\" \n                  size=\"small\" \n                  @click=\"viewUploadedMaterial(scope.row.materialId)\"\n                >\n                  查看\n                </el-button>\n              </template>\n            </el-table-column>\n          </el-table>\n        </div>\n        <el-empty v-else description=\"暂无教学材料任务\"></el-empty>\n      </el-card>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\nimport axios from 'axios'\nimport { Document, Upload } from '@element-plus/icons-vue'\nimport { ElMessage } from 'element-plus'\n\nconst store = useStore()\nconst router = useRouter()\nconst userInfo = computed(() => store.state.user)\n\n// 当前日期\nconst currentDate = computed(() => {\n  const date = new Date()\n  return `${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}日`\n})\n\n// 统计数据\nconst uploadCount = ref(0)\nconst reviewCount = ref(0)\n\n// 快捷操作\nconst quickActions = [\n  {\n    title: '上传材料',\n    description: '上传新的教学材料',\n    icon: 'Upload',\n    iconClass: 'upload-icon',\n    path: '/teacher/material-upload'\n  },\n  {\n    title: '材料审核',\n    description: '查看材料审核状态',\n    icon: 'Document',\n    iconClass: 'review-icon',\n    path: '/teacher/material-review'\n  },\n  {\n    title: '返回首页',\n    description: '回到教师首页',\n    icon: 'HomeFilled',\n    iconClass: 'home-icon',\n    path: '/teacher/home'\n  }\n]\n\n// 最近上传的材料\nconst recentMaterials = ref([])\n// 待审核的材料\nconst pendingReviews = ref([])\n\n// 教学材料任务相关\nconst materialTasks = ref([]);\nconst uncompletedTasksCount = ref(0);\n\n// 获取用户信息\nconst fetchUserInfo = async () => {\n  console.log('开始获取用户信息');\n  try {\n    // 从localStorage获取用户信息\n    const token = localStorage.getItem('token');\n    if (!token) {\n      console.error('用户未登录，请先登录');\n      ElMessage.warning('用户未登录，请先登录');\n      router.push('/login');\n      throw new Error('未登录');\n    }\n\n    // 如果store中已有用户信息，则不重复获取\n    if (userInfo.value && userInfo.value.id) {\n      console.log('从store获取到用户信息:', userInfo.value);\n      return userInfo.value;\n    }\n\n    // 从localStorage尝试获取\n    const localUserInfo = JSON.parse(localStorage.getItem('userInfo') || '{}');\n    if (localUserInfo && localUserInfo.id) {\n      store.commit('SET_USER', localUserInfo);\n      console.log('从localStorage获取并设置用户信息:', localUserInfo);\n      return localUserInfo;\n    }\n\n    // 如果本地存储也没有，则从服务器获取\n    console.log('从服务器获取用户信息');\n    const response = await axios.get('/api/user/info');\n    if (response.data.code === 200 && response.data.data) {\n      store.commit('SET_USER', response.data.data);\n      localStorage.setItem('userInfo', JSON.stringify(response.data.data));\n      console.log('从服务器获取并设置用户信息成功:', response.data.data);\n      return response.data.data;\n    } else {\n      console.warn('获取用户信息失败:', response.data);\n      router.push('/login');\n      throw new Error('获取用户信息失败');\n    }\n  } catch (error) {\n    console.error('获取用户信息出错:', error);\n    router.push('/login');\n    throw error;\n  }\n};\n\n// 获取最近上传的材料\nconst fetchRecentMaterials = async () => {\n  try {\n    // 获取用户ID，首先从Vuex尝试获取\n    let teacherId = userInfo.value?.id;\n    \n    // 如果不存在，尝试从localStorage获取\n    if (!teacherId) {\n      console.warn('从Vuex未获取到教师ID，尝试从localStorage获取');\n      const localUserInfo = JSON.parse(localStorage.getItem('userInfo') || '{}');\n      teacherId = localUserInfo.id;\n    }\n    \n    // 如果仍然无法获取ID，则退出\n    if (!teacherId) {\n      console.error('无法获取教师ID，请重新登录');\n      return;\n    }\n    \n    console.log('开始获取最近上传材料，教师ID:', teacherId);\n    \n    // 请求API\n    const response = await axios.get('/api/material/teacher', {\n      params: {\n        current: 1,\n        size: 5,\n        teacherId: teacherId,\n        type: 0 // 0表示上传的材料\n      }\n    });\n    \n    console.log('最近上传材料响应:', response.data);\n    \n    // 处理响应数据\n    if (response.data && response.data.code === 200 && response.data.data) {\n      recentMaterials.value = response.data.data.records || [];\n      uploadCount.value = response.data.data.total || 0;\n      console.log('已设置最近上传材料数据:', recentMaterials.value.length);\n      console.log('已设置上传总数:', uploadCount.value);\n    } else {\n      console.warn('获取最近上传材料返回异常:', response.data);\n      recentMaterials.value = [];\n      uploadCount.value = 0;\n    }\n  } catch (error) {\n    console.error('获取最近上传材料失败:', error);\n    recentMaterials.value = [];\n    uploadCount.value = 0;\n  }\n}\n\n// 获取待审核的材料\nconst fetchPendingReviews = async () => {\n  try {\n    // 获取用户ID，首先从Vuex尝试获取\n    let teacherId = userInfo.value?.id;\n    \n    // 如果不存在，尝试从localStorage获取\n    if (!teacherId) {\n      console.warn('从Vuex未获取到教师ID，尝试从localStorage获取');\n      const localUserInfo = JSON.parse(localStorage.getItem('userInfo') || '{}');\n      teacherId = localUserInfo.id;\n    }\n    \n    // 如果仍然无法获取ID，则退出\n    if (!teacherId) {\n      console.error('无法获取教师ID，请重新登录');\n      return;\n    }\n    \n    console.log('开始获取待审核材料，教师ID:', teacherId);\n    \n    // 请求API\n    const response = await axios.get('/api/material-review/teacher-submit', {\n      params: {\n        current: 1,\n        size: 5,\n        teacherId: teacherId\n        // 不指定status，获取所有状态的审核\n      }\n    });\n    \n    console.log('待审核材料响应:', response.data);\n    \n    // 处理响应数据\n    if (response.data && response.data.code === 200 && response.data.data) {\n      pendingReviews.value = response.data.data.records || [];\n      console.log('已设置待审核材料数据:', pendingReviews.value.length);\n      \n      // 计算审核中的材料数量 - 状态为1,2,3,4的表示审核中\n      const inReviewCount = pendingReviews.value.filter(item => \n        item.status === 1 || item.status === 2 || \n        item.status === 3 || item.status === 4\n      ).length;\n      \n      reviewCount.value = inReviewCount;\n      console.log('已设置审核中数量:', reviewCount.value);\n    } else {\n      console.warn('获取待审核材料返回异常:', response.data);\n      pendingReviews.value = [];\n      reviewCount.value = 0;\n    }\n  } catch (error) {\n    console.error('获取待审核材料失败:', error);\n    pendingReviews.value = [];\n    reviewCount.value = 0;\n  }\n}\n\n// 状态相关工具函数\nconst getStatusText = (status) => {\n  switch (status) {\n    case 0: return '待审核'\n    case 1: return '课程负责人审核中'\n    case 2: return '专业负责人审核中'\n    case 3: return '副院长审核中'\n    case 4: return '教务人员审核中'\n    case 5: return '审核通过'\n    case 6: return '审核不通过'\n    default: return '未知状态'\n  }\n}\n\nconst getStatusType = (status) => {\n  switch (status) {\n    case 0: return 'info'\n    case 1: case 2: case 3: case 4: return 'warning'\n    case 5: return 'success'\n    case 6: return 'danger'\n    default: return 'info'\n  }\n}\n\n// 页面跳转\nconst navigateTo = (path) => {\n  router.push(path)\n}\n\n// 获取教学材料任务\nconst fetchMaterialTasks = async () => {\n  console.log('======= 开始执行fetchMaterialTasks函数 =======', new Date().toISOString());\n  try {\n    // 获取用户ID\n    let teacherId = userInfo.value?.id;\n    \n    // 如果Vuex中没有，尝试从localStorage获取\n    if (!teacherId) {\n      console.warn('从Vuex未获取到教师ID，尝试从localStorage获取');\n      const localUserInfo = JSON.parse(localStorage.getItem('userInfo') || '{}');\n      teacherId = localUserInfo.id;\n    }\n    \n    if (!teacherId) {\n      console.error('无法获取教师ID，未加载用户信息');\n      throw new Error('无法获取教师ID');\n    }\n\n    console.log('开始获取教师任务列表，教师ID:', teacherId);\n    console.log('请求URL:', '/api/material-task/teacher/tasks');\n    \n    // 构造请求配置，确保请求头和参数正确\n    const config = {\n      url: '/api/material-task/teacher/tasks',\n      method: 'get',\n      params: { teacherId },\n      headers: {\n        'Authorization': `Bearer ${localStorage.getItem('token')}`,\n        'Content-Type': 'application/json'\n      }\n    };\n    \n    console.log('请求配置:', JSON.stringify(config));\n    \n    // 发起请求\n    console.log('正在发送请求...');\n    const response = await axios(config);\n    \n    console.log('接收到教师任务列表响应:', response.status);\n    console.log('响应数据:', JSON.stringify(response.data));\n\n    if (response.data.code === 200) {\n      materialTasks.value = response.data.data || [];\n      console.log('成功获取任务列表，数量:', materialTasks.value.length);\n      \n      if (materialTasks.value.length > 0) {\n        console.log('任务列表第一项:', JSON.stringify(materialTasks.value[0]));\n      } else {\n        console.warn('任务列表为空');\n      }\n      \n      // 计算未完成任务数量\n      uncompletedTasksCount.value = materialTasks.value.filter(task => !task.completed).length;\n      console.log('未完成任务数量:', uncompletedTasksCount.value);\n    } else {\n      console.error('获取教师任务列表失败:', response.data.message);\n      materialTasks.value = [];\n      uncompletedTasksCount.value = 0;\n    }\n  } catch (error) {\n    console.error('获取教学材料任务失败:', error);\n    console.error('错误详情:', error.response || error.message || error);\n    materialTasks.value = [];\n    uncompletedTasksCount.value = 0;\n    ElMessage.error('获取任务列表失败: ' + (error.message || '未知错误'));\n  } finally {\n    console.log('======= fetchMaterialTasks函数执行结束 =======');\n  }\n};\n\n// 判断任务是否过期\nconst isTaskExpired = (deadline) => {\n  if (!deadline) return false;\n  const deadlineDate = new Date(deadline);\n  const now = new Date();\n  return deadlineDate < now;\n};\n\n// 处理为任务上传材料\nconst handleUploadForTask = (task) => {\n  // 跳转到材料上传页面并传递任务参数\n  router.push({\n    path: '/teacher/material-upload',\n    query: {\n      taskId: task.id,\n      materialTypeId: task.materialTypeId,\n      courseId: task.courseId,\n      academicYear: task.academicYear,\n      semester: task.semester\n    }\n  });\n};\n\n// 查看已上传的材料\nconst viewUploadedMaterial = (materialId) => {\n  if (!materialId) return;\n  window.open(`/api/material/download/${materialId}`, '_blank');\n};\n\n// 在组件挂载时获取数据\nonMounted(() => {\n  console.log('====== 教师首页组件挂载 ======');\n  \n  // 先获取用户信息\n  fetchUserInfo().then(() => {\n    console.log('用户信息获取完成，开始获取任务数据');\n    // 依次调用其他数据获取函数\n    fetchRecentMaterials();\n    fetchPendingReviews();\n    \n    // 确保在获取用户信息后调用任务获取\n    console.log('准备调用fetchMaterialTasks函数');\n    fetchMaterialTasks();\n  }).catch(err => {\n    console.error('获取用户信息失败，无法继续获取任务:', err);\n  });\n  \n  // 取消自动更新，避免干扰调试\n  // setInterval(() => {\n  //   fetchMaterialTasks();\n  // }, 300000); // 5分钟更新一次任务数据\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.teacher-home {\n  .welcome-section {\n    margin-bottom: 20px;\n    \n    .welcome-card {\n      height: 100%;\n      \n      .welcome-content {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        \n        .welcome-text {\n          flex: 1;\n          \n          h2 {\n            margin-top: 0;\n            margin-bottom: 10px;\n            color: #303133;\n            font-size: 24px;\n          }\n          \n          .subtitle {\n            color: #606266;\n            font-size: 16px;\n            margin-bottom: 15px;\n          }\n          \n          .description {\n            color: #909399;\n            font-size: 14px;\n            line-height: 1.6;\n          }\n        }\n        \n        .welcome-image {\n          margin-left: 20px;\n          \n          img {\n            width: 120px;\n            height: 120px;\n          }\n        }\n      }\n    }\n    \n    .quick-stats {\n      height: 100%;\n      \n      .stats-content {\n        display: flex;\n        flex-direction: column;\n        gap: 20px;\n        \n        .stat-item {\n          display: flex;\n          align-items: center;\n          \n          .stat-icon {\n            width: 50px;\n            height: 50px;\n            border-radius: 10px;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            margin-right: 15px;\n            \n            .el-icon {\n              font-size: 24px;\n              color: white;\n            }\n            \n            &.upload {\n              background-color: #67c23a;\n            }\n            \n            &.review {\n              background-color: #e6a23c;\n            }\n          }\n          \n          .stat-info {\n            .stat-value {\n              font-size: 24px;\n              font-weight: bold;\n              color: #303133;\n              line-height: 1;\n              margin-bottom: 5px;\n            }\n            \n            .stat-label {\n              font-size: 14px;\n              color: #909399;\n            }\n          }\n        }\n      }\n    }\n  }\n  \n  .quick-actions {\n    margin-bottom: 20px;\n    \n    .action-card {\n      cursor: pointer;\n      transition: all 0.3s;\n      \n      &:hover {\n        transform: translateY(-5px);\n        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);\n      }\n      \n      .action-content {\n        display: flex;\n        align-items: center;\n        padding: 10px 0;\n        \n        .action-icon {\n          width: 60px;\n          height: 60px;\n          border-radius: 50%;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          margin-right: 15px;\n          \n          .el-icon {\n            font-size: 30px;\n            color: white;\n          }\n          \n          &.upload-icon {\n            background-color: #409eff;\n          }\n          \n          &.review-icon {\n            background-color: #e6a23c;\n          }\n          \n          &.home-icon {\n            background-color: #67c23a;\n          }\n        }\n        \n        .action-text {\n          h3 {\n            margin: 0 0 5px 0;\n            font-size: 18px;\n            color: #303133;\n      }\n      \n      p {\n        margin: 0;\n            font-size: 14px;\n            color: #909399;\n          }\n        }\n      }\n    }\n  }\n  \n  .recent-section {\n  .card-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  }\n  }\n}\n</style> ","import script from \"./Home.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Home.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Home.vue?vue&type=style&index=0&id=0d4c2d74&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0d4c2d74\"]])\n\nexport default __exports__"],"names":["store","useStore","router","useRouter","userInfo","computed","state","user","currentDate","date","Date","getFullYear","getMonth","getDate","uploadCount","ref","reviewCount","quickActions","title","description","icon","iconClass","path","recentMaterials","pendingReviews","materialTasks","uncompletedTasksCount","fetchUserInfo","async","console","log","token","localStorage","getItem","error","ElMessage","warning","push","Error","value","id","localUserInfo","JSON","parse","commit","response","axios","data","code","setItem","stringify","warn","fetchRecentMaterials","teacherId","params","current","size","type","records","total","length","fetchPendingReviews","inReviewCount","filter","item","status","getStatusText","getStatusType","navigateTo","fetchMaterialTasks","toISOString","config","url","method","headers","task","completed","message","isTaskExpired","deadline","deadlineDate","now","handleUploadForTask","query","taskId","materialTypeId","courseId","academicYear","semester","viewUploadedMaterial","materialId","window","open","onMounted","then","catch","err","__exports__"],"sourceRoot":""}