"use strict";(self["webpackChunktcr_system_frontend"]=self["webpackChunktcr_system_frontend"]||[]).push([[117],{1117:function(e,a,l){l.r(a),l.d(a,{default:function(){return R}});var t=l(6768),d=l(144),n=l(4232),o=l(1219),u=l(2933),r=l(788),s=l.n(r),i=l(3988);const c={class:"course-management"},m={class:"filter-container"},p={class:"operation-container"},b={class:"pagination-container"},k={class:"dialog-footer"},v={class:"detail-header"},g={class:"detail-info"},f={class:"info-item"},F={class:"info-item"},h={class:"info-item"},_={class:"info-item"},L={class:"info-item"},w={class:"info-item"},y={class:"info-item"},V={key:0,class:"info-item"},T={class:"student-list"};var C={__name:"CourseManagement",setup(e){const a=(0,d.Kh)({pageNum:1,pageSize:10,name:"",teacherId:null,status:null}),l=(0,d.KR)([]),r=(0,d.KR)([]),C=(0,d.KR)(0),W=(0,d.KR)(!1),I=(0,d.KR)(!1),R=(0,d.KR)(""),K=(0,d.KR)("add"),U=(0,d.KR)(null),z=(0,d.Kh)({id:void 0,name:"",description:"",teacherId:null,classTime:"",classLocation:"",endTime:null,endForm:0,endLocation:"",status:1}),S={name:[{required:!0,message:"请输入课程名称",trigger:"blur"},{min:2,max:100,message:"长度在 2 到 100 个字符",trigger:"blur"}],teacherId:[{required:!0,message:"请选择任课教师",trigger:"change"}],classTime:[{required:!0,message:"请输入上课时间",trigger:"blur"}],classLocation:[{required:!0,message:"请输入上课地点",trigger:"blur"}],endTime:[{required:!0,message:"请选择结课时间",trigger:"change"}],endLocation:[{required:!0,message:"请输入考试地点",trigger:"blur"}]},x=(0,d.KR)(!1),$=(0,d.KR)(null),N=async()=>{W.value=!0;try{const e=await s().get("/api/admin/course-management/list",{params:a});200===e.data.code&&(l.value=e.data.data.records,C.value=e.data.data.total)}catch(e){console.error("获取课程列表失败:",e),o.nk.error("获取课程列表失败")}finally{W.value=!1}},X=async()=>{try{const e=await s().get("/api/admin/course-management/available-teachers");200===e.data.code&&(r.value=e.data.data)}catch(e){console.error("获取教师列表失败:",e),o.nk.error("获取教师列表失败")}},q=()=>{a.name="",a.teacherId=null,a.status=null,N()},D=e=>{a.pageNum=e,N()},G=e=>{a.pageSize=e,N()},E=()=>{K.value="add",R.value="添加课程",z.id=void 0,z.name="",z.description="",z.teacherId=null,z.classTime="",z.classLocation="",z.endTime=null,z.endForm=0,z.endLocation="",z.status=1,(0,t.dY)((()=>{I.value=!0,setTimeout((()=>{U.value&&U.value.resetFields()}),0)}))},B=e=>{K.value="edit",R.value="编辑课程",z.id=e.id,z.name=e.name,z.description=e.description,z.teacherId=e.teacherId,z.classTime=e.classTime,z.classLocation=e.classLocation,z.endTime=e.endTime?new Date(e.endTime):null,z.endForm=e.endForm,z.endLocation=e.endLocation,z.status=e.status,(0,t.dY)((()=>{I.value=!0}))},Y=async e=>{try{W.value=!0;const a=await s().get(`/api/admin/course-management/${e.id}/detail`);200===a.data.code&&($.value=null,await(0,t.dY)(),$.value=a.data.data,x.value=!0)}catch(a){console.error("获取课程详情失败:",a),o.nk.error("获取课程详情失败")}finally{W.value=!1}},M=e=>{u.s.confirm(`确定要删除课程"${e.name}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{const a=await s()["delete"](`/api/admin/course-management/${e.id}`);200===a.data.code?(o.nk.success("删除成功"),N()):o.nk.error(a.data.message||"删除失败")}catch(a){console.error("删除课程失败:",a),o.nk.error("删除课程失败")}})).catch((()=>{}))},Q=()=>{U.value.validate((async e=>{if(e)try{let e;e="add"===K.value?await s().post("/api/admin/course-management",z):await s().put("/api/admin/course-management",z),200===e.data.code?(o.nk.success("add"===K.value?"添加成功":"修改成功"),I.value=!1,N()):o.nk.error(e.data.message||("add"===K.value?"添加失败":"修改失败"))}catch(a){console.error("add"===K.value?"添加课程失败:":"修改课程失败:",a),o.nk.error("add"===K.value?"添加课程失败":"修改课程失败")}}))},A=e=>{$.value&&$.value.course&&u.s.confirm(`确定要将学生"${e.realName}"从课程中移除吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{const a=await s()["delete"](`/api/admin/course-management/${$.value.course.id}/student/${e.id}`);200===a.data.code?(o.nk.success("移除成功"),Y($.value.course)):o.nk.error(a.data.message||"移除失败")}catch(a){console.error("移除学生失败:",a),o.nk.error("移除学生失败")}})).catch((()=>{}))},j=e=>{const a=new Date(e);return`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")} ${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}`},H=e=>{switch(e){case 0:return"info";case 1:return"success";case 2:return"danger";default:return"info"}},J=e=>{switch(e){case 0:return"未开始";case 1:return"进行中";case 2:return"已结束";default:return"未知"}};return(0,t.sV)((()=>{N(),X()})),(e,o)=>{const u=(0,t.g2)("el-input"),s=(0,t.g2)("el-form-item"),K=(0,t.g2)("el-option"),X=(0,t.g2)("el-select"),O=(0,t.g2)("el-button"),P=(0,t.g2)("el-form"),Z=(0,t.g2)("el-card"),ee=(0,t.g2)("el-table-column"),ae=(0,t.g2)("el-tag"),le=(0,t.g2)("el-table"),te=(0,t.g2)("el-pagination"),de=(0,t.g2)("el-radio"),ne=(0,t.g2)("el-radio-group"),oe=(0,t.g2)("el-date-picker"),ue=(0,t.g2)("el-dialog"),re=(0,t.g2)("el-divider"),se=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",c,[o[38]||(o[38]=(0,t.Lk)("h1",null,"课程管理",-1)),(0,t.bF)(Z,{class:"filter-card"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",m,[(0,t.bF)(P,{inline:!0,model:a,class:"demo-form-inline"},{default:(0,t.k6)((()=>[(0,t.bF)(s,{label:"课程名称"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:a.name,"onUpdate:modelValue":o[0]||(o[0]=e=>a.name=e),placeholder:"请输入课程名称",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"教师"},{default:(0,t.k6)((()=>[(0,t.bF)(X,(0,t.v6)({modelValue:a.teacherId,"onUpdate:modelValue":o[1]||(o[1]=e=>a.teacherId=e),placeholder:"请选择教师",clearable:""},(0,d.R1)(i.G)),{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(r.value,(e=>((0,t.uX)(),(0,t.Wv)(K,{key:e.id,label:e.realName,value:e.id},null,8,["label","value"])))),128))])),_:1},16,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"状态"},{default:(0,t.k6)((()=>[(0,t.bF)(X,(0,t.v6)({modelValue:a.status,"onUpdate:modelValue":o[2]||(o[2]=e=>a.status=e),placeholder:"请选择状态",clearable:""},(0,d.R1)(i.G)),{default:(0,t.k6)((()=>[(0,t.bF)(K,{label:"未开始",value:0}),(0,t.bF)(K,{label:"进行中",value:1}),(0,t.bF)(K,{label:"已结束",value:2})])),_:1},16,["modelValue"])])),_:1}),(0,t.bF)(s,null,{default:(0,t.k6)((()=>[(0,t.bF)(O,{type:"primary",onClick:N},{default:(0,t.k6)((()=>o[15]||(o[15]=[(0,t.eW)("查询")]))),_:1}),(0,t.bF)(O,{onClick:q},{default:(0,t.k6)((()=>o[16]||(o[16]=[(0,t.eW)("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),(0,t.Lk)("div",p,[(0,t.bF)(O,{type:"primary",onClick:E},{default:(0,t.k6)((()=>o[17]||(o[17]=[(0,t.eW)("添加课程")]))),_:1})])])),_:1}),(0,t.bF)(Z,{class:"table-card"},{default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(le,{data:l.value,style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(ee,{prop:"id",label:"ID",width:"80"}),(0,t.bF)(ee,{prop:"name",label:"课程名称",width:"200"}),(0,t.bF)(ee,{prop:"teacherName",label:"任课教师",width:"150"}),(0,t.bF)(ee,{prop:"classTime",label:"上课时间",width:"150"}),(0,t.bF)(ee,{prop:"classLocation",label:"上课地点",width:"150"}),(0,t.bF)(ee,{label:"结课方式",width:"120"},{default:(0,t.k6)((e=>[(0,t.eW)((0,n.v_)(0===e.row.endForm?"考试":"大作业"),1)])),_:1}),(0,t.bF)(ee,{label:"结课时间",width:"180"},{default:(0,t.k6)((e=>[(0,t.eW)((0,n.v_)(e.row.endTime?j(e.row.endTime):"-"),1)])),_:1}),(0,t.bF)(ee,{prop:"endLocation",label:"考试地点",width:"150"}),(0,t.bF)(ee,{label:"状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(ae,{type:H(e.row.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(J(e.row.status)),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(ee,{label:"操作",fixed:"right",width:"220"},{default:(0,t.k6)((e=>[(0,t.bF)(O,{type:"primary",size:"small",onClick:a=>B(e.row)},{default:(0,t.k6)((()=>o[18]||(o[18]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(O,{type:"success",size:"small",onClick:a=>Y(e.row)},{default:(0,t.k6)((()=>o[19]||(o[19]=[(0,t.eW)("详情")]))),_:2},1032,["onClick"]),(0,t.bF)(O,{type:"danger",size:"small",onClick:a=>M(e.row)},{default:(0,t.k6)((()=>o[20]||(o[20]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[se,W.value]]),(0,t.Lk)("div",b,[(0,t.bF)(te,{"current-page":a.pageNum,"page-sizes":[10,20,50,100],"page-size":a.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:C.value,onSizeChange:G,onCurrentChange:D},null,8,["current-page","page-size","total"])])])),_:1}),(0,t.bF)(ue,(0,t.v6)({title:R.value,modelValue:I.value,"onUpdate:modelValue":o[13]||(o[13]=e=>I.value=e),width:"650px"},(0,d.R1)(i.G)),{footer:(0,t.k6)((()=>[(0,t.Lk)("span",k,[(0,t.bF)(O,{onClick:o[12]||(o[12]=e=>I.value=!1)},{default:(0,t.k6)((()=>o[26]||(o[26]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(O,{type:"primary",onClick:Q},{default:(0,t.k6)((()=>o[27]||(o[27]=[(0,t.eW)("确定")]))),_:1})])])),default:(0,t.k6)((()=>[(0,t.bF)(P,{model:z,rules:S,ref_key:"courseFormRef",ref:U,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(s,{label:"课程名称",prop:"name"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:z.name,"onUpdate:modelValue":o[3]||(o[3]=e=>z.name=e),placeholder:"请输入课程名称"},null,8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"课程描述",prop:"description"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{type:"textarea",modelValue:z.description,"onUpdate:modelValue":o[4]||(o[4]=e=>z.description=e),placeholder:"请输入课程描述",rows:"3"},null,8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"任课教师",prop:"teacherId"},{default:(0,t.k6)((()=>[(0,t.bF)(X,(0,t.v6)({modelValue:z.teacherId,"onUpdate:modelValue":o[5]||(o[5]=e=>z.teacherId=e),placeholder:"请选择任课教师",style:{width:"100%"}},(0,d.R1)(i.G)),{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(r.value,(e=>((0,t.uX)(),(0,t.Wv)(K,{key:e.id,label:e.realName,value:e.id},null,8,["label","value"])))),128))])),_:1},16,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"上课时间",prop:"classTime"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:z.classTime,"onUpdate:modelValue":o[6]||(o[6]=e=>z.classTime=e),placeholder:"例如：周一 8:00-9:40"},null,8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"上课地点",prop:"classLocation"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:z.classLocation,"onUpdate:modelValue":o[7]||(o[7]=e=>z.classLocation=e),placeholder:"例如：教学楼A-101"},null,8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"结课形式",prop:"endForm"},{default:(0,t.k6)((()=>[(0,t.bF)(ne,{modelValue:z.endForm,"onUpdate:modelValue":o[8]||(o[8]=e=>z.endForm=e)},{default:(0,t.k6)((()=>[(0,t.bF)(de,{label:0},{default:(0,t.k6)((()=>o[21]||(o[21]=[(0,t.eW)("考试")]))),_:1}),(0,t.bF)(de,{label:1},{default:(0,t.k6)((()=>o[22]||(o[22]=[(0,t.eW)("大作业")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"结课时间",prop:"endTime"},{default:(0,t.k6)((()=>[(0,t.bF)(oe,(0,t.v6)({modelValue:z.endTime,"onUpdate:modelValue":o[9]||(o[9]=e=>z.endTime=e),type:"datetime",placeholder:"选择结课时间",style:{width:"100%"}},(0,d.R1)(i.G)),null,16,["modelValue"])])),_:1}),0===z.endForm?((0,t.uX)(),(0,t.Wv)(s,{key:0,label:"考试地点",prop:"endLocation"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:z.endLocation,"onUpdate:modelValue":o[10]||(o[10]=e=>z.endLocation=e),placeholder:"例如：教学楼C-203"},null,8,["modelValue"])])),_:1})):(0,t.Q3)("",!0),(0,t.bF)(s,{label:"课程状态",prop:"status"},{default:(0,t.k6)((()=>[(0,t.bF)(ne,{modelValue:z.status,"onUpdate:modelValue":o[11]||(o[11]=e=>z.status=e)},{default:(0,t.k6)((()=>[(0,t.bF)(de,{label:0},{default:(0,t.k6)((()=>o[23]||(o[23]=[(0,t.eW)("未开始")]))),_:1}),(0,t.bF)(de,{label:1},{default:(0,t.k6)((()=>o[24]||(o[24]=[(0,t.eW)("进行中")]))),_:1}),(0,t.bF)(de,{label:2},{default:(0,t.k6)((()=>o[25]||(o[25]=[(0,t.eW)("已结束")]))),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},16,["title","modelValue"]),(0,t.bF)(ue,(0,t.v6)({title:"课程详情",modelValue:x.value,"onUpdate:modelValue":o[14]||(o[14]=e=>x.value=e),width:"800px"},(0,d.R1)(i.G)),{default:(0,t.k6)((()=>[$.value?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.Lk)("div",v,[(0,t.Lk)("h2",null,(0,n.v_)($.value.course.name),1),(0,t.bF)(ae,{type:H($.value.course.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(J($.value.course.status)),1)])),_:1},8,["type"])]),(0,t.Lk)("div",g,[(0,t.Lk)("div",f,[o[28]||(o[28]=(0,t.Lk)("label",null,"课程ID：",-1)),(0,t.Lk)("span",null,(0,n.v_)($.value.course.id),1)]),(0,t.Lk)("div",F,[o[29]||(o[29]=(0,t.Lk)("label",null,"课程描述：",-1)),(0,t.Lk)("span",null,(0,n.v_)($.value.course.description||"无"),1)]),(0,t.Lk)("div",h,[o[30]||(o[30]=(0,t.Lk)("label",null,"任课教师：",-1)),(0,t.Lk)("span",null,(0,n.v_)($.value.teacher?$.value.teacher.realName:"未知"),1)]),(0,t.Lk)("div",_,[o[31]||(o[31]=(0,t.Lk)("label",null,"上课时间：",-1)),(0,t.Lk)("span",null,(0,n.v_)($.value.course.classTime||"未设置"),1)]),(0,t.Lk)("div",L,[o[32]||(o[32]=(0,t.Lk)("label",null,"上课地点：",-1)),(0,t.Lk)("span",null,(0,n.v_)($.value.course.classLocation||"未设置"),1)]),(0,t.Lk)("div",w,[o[33]||(o[33]=(0,t.Lk)("label",null,"结课形式：",-1)),(0,t.Lk)("span",null,(0,n.v_)(0===$.value.course.endForm?"考试":"大作业"),1)]),(0,t.Lk)("div",y,[o[34]||(o[34]=(0,t.Lk)("label",null,"结课时间：",-1)),(0,t.Lk)("span",null,(0,n.v_)($.value.course.endTime?j($.value.course.endTime):"未设置"),1)]),0===$.value.course.endForm?((0,t.uX)(),(0,t.CE)("div",V,[o[35]||(o[35]=(0,t.Lk)("label",null,"考试地点：",-1)),(0,t.Lk)("span",null,(0,n.v_)($.value.course.endLocation||"未设置"),1)])):(0,t.Q3)("",!0)]),(0,t.bF)(re,{"content-position":"left"},{default:(0,t.k6)((()=>o[36]||(o[36]=[(0,t.eW)("选课学生")]))),_:1}),(0,t.Lk)("div",T,[(0,t.bF)(le,{data:$.value.students,style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(ee,{prop:"id",label:"ID",width:"80"}),(0,t.bF)(ee,{prop:"username",label:"学号",width:"150"}),(0,t.bF)(ee,{prop:"realName",label:"姓名",width:"150"}),(0,t.bF)(ee,{prop:"email",label:"邮箱"}),(0,t.bF)(ee,{prop:"phone",label:"手机号"}),(0,t.bF)(ee,{label:"操作",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(O,{type:"danger",size:"small",onClick:a=>A(e.row)},{default:(0,t.k6)((()=>o[37]||(o[37]=[(0,t.eW)("移除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])])],64)):(0,t.Q3)("",!0)])),_:1},16,["modelValue"])])}}},W=l(1241);const I=(0,W.A)(C,[["__scopeId","data-v-88a34908"]]);var R=I}}]);
//# sourceMappingURL=117.21f8d27e.js.map