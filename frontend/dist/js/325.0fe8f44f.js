"use strict";(self["webpackChunktcr_system_frontend"]=self["webpackChunktcr_system_frontend"]||[]).push([[325],{8325:function(e,a,l){l.r(a),l.d(a,{default:function(){return F}});var t=l(6768),d=l(144),o=l(1219),r=l(2933),u=l(788),s=l.n(u);const n={class:"student-management"},i={class:"filter-container"},c={class:"operation-container"},m={class:"pagination-container"},p={class:"dialog-footer"},b={class:"dialog-footer"},k={class:"course-management"};var v={__name:"StudentManagement",setup(e){const a=(0,d.Kh)({pageNum:1,pageSize:10,realName:"",username:"",classId:void 0}),l=(0,d.KR)([]),u=(0,d.KR)([]),v=(0,d.KR)([]),g=(0,d.KR)(0),f=(0,d.KR)(!1),F=(0,d.KR)(!1),h=(0,d.KR)(""),y=(0,d.KR)("add"),_=(0,d.KR)(null),V=(0,d.Kh)({id:void 0,username:"",realName:"",password:"",classId:void 0,email:"",phone:"",status:1,role:0}),w={username:[{required:!0,message:"请输入学号",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],realName:[{required:!0,message:"请输入姓名",trigger:"blur"}],password:[{required:"add"===y,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],classId:[{required:!0,message:"请选择班级",trigger:"change"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]},I=(0,d.KR)(!1),C=(0,d.KR)(null),K=(0,d.Kh)({name:"",majorId:void 0,year:"",description:""}),N={name:[{required:!0,message:"请输入班级名称",trigger:"blur"}],majorId:[{required:!0,message:"请选择所属专业",trigger:"change"}],year:[{required:!0,message:"请选择入学年份",trigger:"change"}]},W=(0,d.KR)(!1),U=(0,d.KR)("selected"),R=(0,d.KR)(!1),z=(0,d.KR)({}),x=(0,d.KR)([]),X=(0,d.KR)([]),L=async()=>{f.value=!0;try{const e=await s().get("/api/admin/student/list",{params:a});200===e.data.code&&(l.value=e.data.data.records,g.value=e.data.data.total,l.value.forEach((e=>{if(!e.className&&e.classId){const a=u.value.find((a=>a.id===e.classId));a&&(e.className=a.name)}})))}catch(e){console.error("获取学生列表失败:",e),o.nk.error("获取学生列表失败")}finally{f.value=!1}},j=async()=>{try{const e=await s().get("/api/admin/class/list");200===e.data.code&&(u.value=e.data.data)}catch(e){console.error("获取班级列表失败:",e),o.nk.error("获取班级列表失败")}},Y=async()=>{try{const e=await s().get("/api/admin/major/list");200===e.data.code&&(v.value=e.data.data)}catch(e){console.error("获取专业列表失败:",e),o.nk.error("获取专业列表失败")}},q=()=>{a.realName="",a.username="",a.classId=void 0,L()},E=e=>{a.pageNum=e,L()},S=e=>{a.pageSize=e,L()},T=()=>{y.value="add",h.value="添加学生",V.id=void 0,V.username="",V.realName="",V.password="",V.classId=void 0,V.email="",V.phone="",V.status=1,V.role=0,F.value=!0},D=e=>{y.value="edit",h.value="编辑学生",V.id=e.id,V.username=e.username,V.realName=e.realName,V.password="",V.classId=e.classId,V.email=e.email,V.phone=e.phone,V.status=e.status,V.role=e.role,F.value=!0},$=e=>{r.s.confirm("确定要删除该学生吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{const a=await s()["delete"](`/api/admin/student/${e.id}`);200===a.data.code?(o.nk.success("删除成功"),L()):o.nk.error(a.data.message||"删除失败")}catch(a){console.error("删除学生失败:",a),o.nk.error("删除学生失败")}})).catch((()=>{}))},B=async e=>{try{const a=await s().put("/api/admin/student/status",{id:e.id,status:e.status});200===a.data.code?o.nk.success((1===e.status?"启用":"禁用")+"成功"):(o.nk.error(a.data.message||"操作失败"),e.status=1===e.status?0:1)}catch(a){console.error("修改状态失败:",a),o.nk.error("修改状态失败"),e.status=1===e.status?0:1}},Q=()=>{_.value.validate((async e=>{if(e)try{let e;e="add"===y.value?await s().post("/api/admin/student",V):await s().put("/api/admin/student",V),200===e.data.code?(o.nk.success("add"===y.value?"添加成功":"修改成功"),F.value=!1,L()):o.nk.error(e.data.message||("add"===y.value?"添加失败":"修改失败"))}catch(a){console.error("add"===y.value?"添加学生失败:":"修改学生失败:",a),o.nk.error("add"===y.value?"添加学生失败":"修改学生失败")}}))},A=()=>{K.name="",K.majorId=void 0,K.year="",K.description="",I.value=!0},M=()=>{C.value.validate((async e=>{if(e)try{const e=await s().post("/api/admin/class",K);200===e.data.code?(o.nk.success("添加班级成功"),I.value=!1,j()):o.nk.error(e.data.message||"添加班级失败")}catch(a){console.error("添加班级失败:",a),o.nk.error("添加班级失败")}}))},G=async e=>{z.value=e,W.value=!0,U.value="selected",await H(e.id)},H=async e=>{R.value=!0;try{const a=await s().get(`/api/student/course/${e}`);200===a.data.code&&(x.value=a.data.data||[]);const l=await s().get("/api/admin/course/available",{params:{studentId:e}});200===l.data.code&&(X.value=l.data.data||[])}catch(a){console.error("获取学生课程失败:",a),o.nk.error("获取学生课程失败")}finally{R.value=!1}},J=async e=>{try{const a=await s().post("/api/admin/student/course/select",{studentId:z.value.id,courseId:e.id});200===a.data.code?(o.nk.success("选课成功"),await H(z.value.id)):o.nk.error(a.data.message||"选课失败")}catch(a){console.error("选课失败:",a),o.nk.error("选课失败")}},O=async e=>{try{const a=await s().post("/api/admin/student/course/drop",{studentId:z.value.id,courseId:e.id});200===a.data.code?(o.nk.success("退课成功"),await H(z.value.id)):o.nk.error(a.data.message||"退课失败")}catch(a){console.error("退课失败:",a),o.nk.error("退课失败")}};return(0,t.sV)((()=>{L(),j(),Y()})),(e,d)=>{const o=(0,t.g2)("el-input"),r=(0,t.g2)("el-form-item"),s=(0,t.g2)("el-option"),j=(0,t.g2)("el-select"),Y=(0,t.g2)("el-button"),H=(0,t.g2)("el-form"),P=(0,t.g2)("el-card"),Z=(0,t.g2)("el-table-column"),ee=(0,t.g2)("el-switch"),ae=(0,t.g2)("el-table"),le=(0,t.g2)("el-pagination"),te=(0,t.g2)("el-radio"),de=(0,t.g2)("el-radio-group"),oe=(0,t.g2)("el-dialog"),re=(0,t.g2)("el-date-picker"),ue=(0,t.g2)("el-tab-pane"),se=(0,t.g2)("el-tabs"),ne=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",n,[d[37]||(d[37]=(0,t.Lk)("h1",null,"学生管理",-1)),(0,t.bF)(P,{class:"filter-card"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",i,[(0,t.bF)(H,{inline:!0,model:a,class:"demo-form-inline"},{default:(0,t.k6)((()=>[(0,t.bF)(r,{label:"学生姓名"},{default:(0,t.k6)((()=>[(0,t.bF)(o,{modelValue:a.realName,"onUpdate:modelValue":d[0]||(d[0]=e=>a.realName=e),placeholder:"请输入学生姓名",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(r,{label:"学号"},{default:(0,t.k6)((()=>[(0,t.bF)(o,{modelValue:a.username,"onUpdate:modelValue":d[1]||(d[1]=e=>a.username=e),placeholder:"请输入学号",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(r,{label:"班级"},{default:(0,t.k6)((()=>[(0,t.bF)(j,{modelValue:a.classId,"onUpdate:modelValue":d[2]||(d[2]=e=>a.classId=e),placeholder:"请选择班级",clearable:""},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(u.value,(e=>((0,t.uX)(),(0,t.Wv)(s,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(r,null,{default:(0,t.k6)((()=>[(0,t.bF)(Y,{type:"primary",onClick:L},{default:(0,t.k6)((()=>d[21]||(d[21]=[(0,t.eW)("查询")]))),_:1}),(0,t.bF)(Y,{onClick:q},{default:(0,t.k6)((()=>d[22]||(d[22]=[(0,t.eW)("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),(0,t.Lk)("div",c,[(0,t.bF)(Y,{type:"primary",onClick:T},{default:(0,t.k6)((()=>d[23]||(d[23]=[(0,t.eW)("添加学生")]))),_:1}),(0,t.bF)(Y,{type:"success",onClick:A},{default:(0,t.k6)((()=>d[24]||(d[24]=[(0,t.eW)("添加班级")]))),_:1})])])),_:1}),(0,t.bF)(P,{class:"table-card"},{default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(ae,{data:l.value,style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(Z,{prop:"id",label:"ID",width:"80"}),(0,t.bF)(Z,{prop:"username",label:"学号",width:"120"}),(0,t.bF)(Z,{prop:"realName",label:"姓名",width:"120"}),(0,t.bF)(Z,{prop:"className",label:"班级"}),(0,t.bF)(Z,{prop:"email",label:"邮箱"}),(0,t.bF)(Z,{prop:"phone",label:"手机号"}),(0,t.bF)(Z,{label:"状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(ee,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":0,onChange:a=>B(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),(0,t.bF)(Z,{label:"操作",width:"250"},{default:(0,t.k6)((e=>[(0,t.bF)(Y,{type:"primary",size:"small",onClick:a=>D(e.row)},{default:(0,t.k6)((()=>d[25]||(d[25]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(Y,{type:"success",size:"small",onClick:a=>G(e.row)},{default:(0,t.k6)((()=>d[26]||(d[26]=[(0,t.eW)("管理选课")]))),_:2},1032,["onClick"]),(0,t.bF)(Y,{type:"danger",size:"small",onClick:a=>$(e.row)},{default:(0,t.k6)((()=>d[27]||(d[27]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[ne,f.value]]),(0,t.Lk)("div",m,[(0,t.bF)(le,{background:"",layout:"total, sizes, prev, pager, next, jumper",total:g.value,"page-size":a.pageSize,"current-page":a.pageNum,"page-sizes":[10,20,50,100],onCurrentChange:E,onSizeChange:S},null,8,["total","page-size","current-page"])])])),_:1}),(0,t.bF)(oe,{title:h.value,modelValue:F.value,"onUpdate:modelValue":d[12]||(d[12]=e=>F.value=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",p,[(0,t.bF)(Y,{onClick:d[11]||(d[11]=e=>F.value=!1)},{default:(0,t.k6)((()=>d[31]||(d[31]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(Y,{type:"primary",onClick:Q},{default:(0,t.k6)((()=>d[32]||(d[32]=[(0,t.eW)("确定")]))),_:1})])])),default:(0,t.k6)((()=>[(0,t.bF)(H,{model:V,rules:w,ref_key:"studentFormRef",ref:_,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(r,{label:"学号",prop:"username"},{default:(0,t.k6)((()=>[(0,t.bF)(o,{modelValue:V.username,"onUpdate:modelValue":d[3]||(d[3]=e=>V.username=e),placeholder:"请输入学号"},null,8,["modelValue"])])),_:1}),(0,t.bF)(r,{label:"姓名",prop:"realName"},{default:(0,t.k6)((()=>[(0,t.bF)(o,{modelValue:V.realName,"onUpdate:modelValue":d[4]||(d[4]=e=>V.realName=e),placeholder:"请输入姓名"},null,8,["modelValue"])])),_:1}),"add"===y.value?((0,t.uX)(),(0,t.Wv)(r,{key:0,label:"密码",prop:"password"},{default:(0,t.k6)((()=>[(0,t.bF)(o,{modelValue:V.password,"onUpdate:modelValue":d[5]||(d[5]=e=>V.password=e),placeholder:"请输入密码","show-password":""},null,8,["modelValue"])])),_:1})):(0,t.Q3)("",!0),"edit"===y.value?((0,t.uX)(),(0,t.Wv)(r,{key:1,label:"修改密码"},{default:(0,t.k6)((()=>[(0,t.bF)(o,{modelValue:V.password,"onUpdate:modelValue":d[6]||(d[6]=e=>V.password=e),placeholder:"不修改请留空","show-password":""},null,8,["modelValue"]),d[28]||(d[28]=(0,t.Lk)("span",{class:"tip-text"},"不修改密码请留空",-1))])),_:1})):(0,t.Q3)("",!0),(0,t.bF)(r,{label:"班级",prop:"classId"},{default:(0,t.k6)((()=>[(0,t.bF)(j,{modelValue:V.classId,"onUpdate:modelValue":d[7]||(d[7]=e=>V.classId=e),placeholder:"请选择班级",style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(u.value,(e=>((0,t.uX)(),(0,t.Wv)(s,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(r,{label:"邮箱",prop:"email"},{default:(0,t.k6)((()=>[(0,t.bF)(o,{modelValue:V.email,"onUpdate:modelValue":d[8]||(d[8]=e=>V.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])])),_:1}),(0,t.bF)(r,{label:"手机号",prop:"phone"},{default:(0,t.k6)((()=>[(0,t.bF)(o,{modelValue:V.phone,"onUpdate:modelValue":d[9]||(d[9]=e=>V.phone=e),placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1}),(0,t.bF)(r,{label:"状态",prop:"status"},{default:(0,t.k6)((()=>[(0,t.bF)(de,{modelValue:V.status,"onUpdate:modelValue":d[10]||(d[10]=e=>V.status=e)},{default:(0,t.k6)((()=>[(0,t.bF)(te,{label:1},{default:(0,t.k6)((()=>d[29]||(d[29]=[(0,t.eW)("启用")]))),_:1}),(0,t.bF)(te,{label:0},{default:(0,t.k6)((()=>d[30]||(d[30]=[(0,t.eW)("禁用")]))),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"]),(0,t.bF)(oe,{title:"添加班级",modelValue:I.value,"onUpdate:modelValue":d[18]||(d[18]=e=>I.value=e),width:"500px"},{footer:(0,t.k6)((()=>[(0,t.Lk)("span",b,[(0,t.bF)(Y,{onClick:d[17]||(d[17]=e=>I.value=!1)},{default:(0,t.k6)((()=>d[33]||(d[33]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(Y,{type:"primary",onClick:M},{default:(0,t.k6)((()=>d[34]||(d[34]=[(0,t.eW)("确定")]))),_:1})])])),default:(0,t.k6)((()=>[(0,t.bF)(H,{model:K,rules:N,ref_key:"classFormRef",ref:C,"label-width":"100px"},{default:(0,t.k6)((()=>[(0,t.bF)(r,{label:"班级名称",prop:"name"},{default:(0,t.k6)((()=>[(0,t.bF)(o,{modelValue:K.name,"onUpdate:modelValue":d[13]||(d[13]=e=>K.name=e),placeholder:"请输入班级名称"},null,8,["modelValue"])])),_:1}),(0,t.bF)(r,{label:"所属专业",prop:"majorId"},{default:(0,t.k6)((()=>[(0,t.bF)(j,{modelValue:K.majorId,"onUpdate:modelValue":d[14]||(d[14]=e=>K.majorId=e),placeholder:"请选择所属专业",style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(v.value,(e=>((0,t.uX)(),(0,t.Wv)(s,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(r,{label:"入学年份",prop:"year"},{default:(0,t.k6)((()=>[(0,t.bF)(re,{modelValue:K.year,"onUpdate:modelValue":d[15]||(d[15]=e=>K.year=e),type:"year",placeholder:"选择年份",format:"YYYY","value-format":"YYYY",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(r,{label:"备注",prop:"description"},{default:(0,t.k6)((()=>[(0,t.bF)(o,{modelValue:K.description,"onUpdate:modelValue":d[16]||(d[16]=e=>K.description=e),type:"textarea",placeholder:"请输入班级描述",rows:"3"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,t.bF)(oe,{title:`管理选课 - ${z.value.realName}`,modelValue:W.value,"onUpdate:modelValue":d[20]||(d[20]=e=>W.value=e),width:"700px"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",k,[(0,t.bF)(se,{modelValue:U.value,"onUpdate:modelValue":d[19]||(d[19]=e=>U.value=e)},{default:(0,t.k6)((()=>[(0,t.bF)(ue,{label:"已选课程",name:"selected"},{default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(ae,{data:x.value,style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(Z,{prop:"id",label:"ID",width:"80"}),(0,t.bF)(Z,{prop:"name",label:"课程名称"}),(0,t.bF)(Z,{prop:"teacherName",label:"授课教师"}),(0,t.bF)(Z,{prop:"classTime",label:"上课时间"}),(0,t.bF)(Z,{prop:"classLocation",label:"上课地点"}),(0,t.bF)(Z,{label:"操作",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(Y,{type:"danger",size:"small",onClick:a=>O(e.row)},{default:(0,t.k6)((()=>d[35]||(d[35]=[(0,t.eW)("退选")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[ne,R.value]])])),_:1}),(0,t.bF)(ue,{label:"可选课程",name:"available"},{default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(ae,{data:X.value,style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(Z,{prop:"id",label:"ID",width:"80"}),(0,t.bF)(Z,{prop:"name",label:"课程名称"}),(0,t.bF)(Z,{prop:"teacherName",label:"授课教师"}),(0,t.bF)(Z,{prop:"classTime",label:"上课时间"}),(0,t.bF)(Z,{prop:"classLocation",label:"上课地点"}),(0,t.bF)(Z,{label:"操作",width:"120"},{default:(0,t.k6)((e=>[(0,t.bF)(Y,{type:"success",size:"small",onClick:a=>J(e.row)},{default:(0,t.k6)((()=>d[36]||(d[36]=[(0,t.eW)("选课")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[ne,R.value]])])),_:1})])),_:1},8,["modelValue"])])])),_:1},8,["title","modelValue"])])}}},g=l(1241);const f=(0,g.A)(v,[["__scopeId","data-v-089be4fc"]]);var F=f}}]);
//# sourceMappingURL=325.0fe8f44f.js.map