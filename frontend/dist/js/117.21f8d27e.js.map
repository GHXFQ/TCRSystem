{"version":3,"file":"js/117.21f8d27e.js","mappings":"0sBAgPA,MAAMA,GAAcC,EAAAA,EAAAA,IAAS,CAC3BC,QAAS,EACTC,SAAU,GACVC,KAAM,GACNC,UAAW,KACXC,OAAQ,OAIJC,GAAaC,EAAAA,EAAAA,IAAI,IAEjBC,GAAcD,EAAAA,EAAAA,IAAI,IAElBE,GAAQF,EAAAA,EAAAA,IAAI,GAEZG,GAAUH,EAAAA,EAAAA,KAAI,GAGdI,GAAgBJ,EAAAA,EAAAA,KAAI,GACpBK,GAAcL,EAAAA,EAAAA,IAAI,IAClBM,GAAaN,EAAAA,EAAAA,IAAI,OACjBO,GAAgBP,EAAAA,EAAAA,IAAI,MACpBQ,GAAaf,EAAAA,EAAAA,IAAS,CAC1BgB,QAAIC,EACJd,KAAM,GACNe,YAAa,GACbd,UAAW,KACXe,UAAW,GACXC,cAAe,GACfC,QAAS,KACTC,QAAS,EACTC,YAAa,GACblB,OAAQ,IAIJmB,EAAc,CAClBrB,KAAM,CACJ,CAAEsB,UAAU,EAAMC,QAAS,UAAWC,QAAS,QAC/C,CAAEC,IAAK,EAAGC,IAAK,IAAKH,QAAS,kBAAmBC,QAAS,SAE3DvB,UAAW,CACT,CAAEqB,UAAU,EAAMC,QAAS,UAAWC,QAAS,WAEjDR,UAAW,CACT,CAAEM,UAAU,EAAMC,QAAS,UAAWC,QAAS,SAEjDP,cAAe,CACb,CAAEK,UAAU,EAAMC,QAAS,UAAWC,QAAS,SAEjDN,QAAS,CACP,CAAEI,UAAU,EAAMC,QAAS,UAAWC,QAAS,WAEjDJ,YAAa,CACX,CAAEE,UAAU,EAAMC,QAAS,UAAWC,QAAS,UAK7CG,GAAsBvB,EAAAA,EAAAA,KAAI,GAC1BwB,GAAexB,EAAAA,EAAAA,IAAI,MAGnByB,EAAeC,UACnBvB,EAAQwB,OAAQ,EAChB,IACE,MAAMC,QAAiBC,IAAAA,IAAU,oCAAqC,CACpEC,OAAQtC,IAEiB,MAAvBoC,EAASG,KAAKC,OAChBjC,EAAW4B,MAAQC,EAASG,KAAKA,KAAKE,QACtC/B,EAAMyB,MAAQC,EAASG,KAAKA,KAAK7B,MAErC,CAAE,MAAOgC,GACPC,QAAQD,MAAM,YAAaA,GAC3BE,EAAAA,GAAUF,MAAM,WAClB,CAAE,QACA/B,EAAQwB,OAAQ,CAClB,GAIIU,EAAgBX,UACpB,IACE,MAAME,QAAiBC,IAAAA,IAAU,mDACN,MAAvBD,EAASG,KAAKC,OAChB/B,EAAY0B,MAAQC,EAASG,KAAKA,KAEtC,CAAE,MAAOG,GACPC,QAAQD,MAAM,YAAaA,GAC3BE,EAAAA,GAAUF,MAAM,WAClB,GAIII,EAAaA,KACjB9C,EAAYI,KAAO,GACnBJ,EAAYK,UAAY,KACxBL,EAAYM,OAAS,KACrB2B,GAAc,EAIVc,EAAuBC,IAC3BhD,EAAYE,QAAU8C,EACtBf,GAAc,EAIVgB,EAAoBD,IACxBhD,EAAYG,SAAW6C,EACvBf,GAAc,EAIViB,EAAYA,KAChBpC,EAAWqB,MAAQ,MACnBtB,EAAYsB,MAAQ,OACpBnB,EAAWC,QAAKC,EAChBF,EAAWZ,KAAO,GAClBY,EAAWG,YAAc,GACzBH,EAAWX,UAAY,KACvBW,EAAWI,UAAY,GACvBJ,EAAWK,cAAgB,GAC3BL,EAAWM,QAAU,KACrBN,EAAWO,QAAU,EACrBP,EAAWQ,YAAc,GACzBR,EAAWV,OAAS,GAGpB6C,EAAAA,EAAAA,KAAS,KACPvC,EAAcuB,OAAQ,EAEtBiB,YAAW,KACTrC,EAAcoB,OAASpB,EAAcoB,MAAMkB,aAAa,GACvD,EAAE,GACL,EAIEC,EAAcC,IAClBzC,EAAWqB,MAAQ,OACnBtB,EAAYsB,MAAQ,OACpBnB,EAAWC,GAAKsC,EAAItC,GACpBD,EAAWZ,KAAOmD,EAAInD,KACtBY,EAAWG,YAAcoC,EAAIpC,YAC7BH,EAAWX,UAAYkD,EAAIlD,UAC3BW,EAAWI,UAAYmC,EAAInC,UAC3BJ,EAAWK,cAAgBkC,EAAIlC,cAC/BL,EAAWM,QAAUiC,EAAIjC,QAAU,IAAIkC,KAAKD,EAAIjC,SAAW,KAC3DN,EAAWO,QAAUgC,EAAIhC,QACzBP,EAAWQ,YAAc+B,EAAI/B,YAC7BR,EAAWV,OAASiD,EAAIjD,QAGxB6C,EAAAA,EAAAA,KAAS,KACPvC,EAAcuB,OAAQ,CAAI,GAC1B,EAIEsB,EAAevB,UACnB,IACEvB,EAAQwB,OAAQ,EAChB,MAAMC,QAAiBC,IAAAA,IAAU,gCAAgCkB,EAAItC,aAC1C,MAAvBmB,EAASG,KAAKC,OAEhBR,EAAaG,MAAQ,WAGfgB,EAAAA,EAAAA,MAGNnB,EAAaG,MAAQC,EAASG,KAAKA,KACnCR,EAAoBI,OAAQ,EAEhC,CAAE,MAAOO,GACPC,QAAQD,MAAM,YAAaA,GAC3BE,EAAAA,GAAUF,MAAM,WAClB,CAAE,QACA/B,EAAQwB,OAAQ,CAClB,GAIIuB,EAAgBH,IACpBI,EAAAA,EAAaC,QAAQ,WAAWL,EAAInD,UAAW,KAAM,CACnDyD,kBAAmB,KACnBC,iBAAkB,KAClBC,KAAM,YACLC,MAAK9B,UACN,IACE,MAAME,QAAiBC,IAAAA,UAAa,gCAAgCkB,EAAItC,MAC7C,MAAvBmB,EAASG,KAAKC,MAChBI,EAAAA,GAAUqB,QAAQ,QAClBhC,KAEAW,EAAAA,GAAUF,MAAMN,EAASG,KAAKZ,SAAW,OAE7C,CAAE,MAAOe,GACPC,QAAQD,MAAM,UAAWA,GACzBE,EAAAA,GAAUF,MAAM,SAClB,KACCwB,OAAM,QAAS,EAIdC,EAAmBA,KACvBpD,EAAcoB,MAAMiC,UAASlC,UAC3B,GAAImC,EACF,IACE,IAAIjC,EAEFA,EADuB,QAArBtB,EAAWqB,YACIE,IAAAA,KAAW,+BAAgCrB,SAE3CqB,IAAAA,IAAU,+BAAgCrB,GAGlC,MAAvBoB,EAASG,KAAKC,MAChBI,EAAAA,GAAUqB,QAA6B,QAArBnD,EAAWqB,MAAkB,OAAS,QACxDvB,EAAcuB,OAAQ,EACtBF,KAEAW,EAAAA,GAAUF,MAAMN,EAASG,KAAKZ,UAAiC,QAArBb,EAAWqB,MAAkB,OAAS,QAEpF,CAAE,MAAOO,GACPC,QAAQD,MAA2B,QAArB5B,EAAWqB,MAAkB,UAAY,UAAWO,GAClEE,EAAAA,GAAUF,MAA2B,QAArB5B,EAAWqB,MAAkB,SAAW,SAC1D,CACF,GACA,EAIEmC,EAAuBC,IACtBvC,EAAaG,OAAUH,EAAaG,MAAMqC,QAE/Cb,EAAAA,EAAaC,QAAQ,UAAUW,EAAQE,oBAAqB,KAAM,CAChEZ,kBAAmB,KACnBC,iBAAkB,KAClBC,KAAM,YACLC,MAAK9B,UACN,IACE,MAAME,QAAiBC,IAAAA,UAAa,gCAAgCL,EAAaG,MAAMqC,OAAOvD,cAAcsD,EAAQtD,MACzF,MAAvBmB,EAASG,KAAKC,MAChBI,EAAAA,GAAUqB,QAAQ,QAElBR,EAAazB,EAAaG,MAAMqC,SAEhC5B,EAAAA,GAAUF,MAAMN,EAASG,KAAKZ,SAAW,OAE7C,CAAE,MAAOe,GACPC,QAAQD,MAAM,UAAWA,GACzBE,EAAAA,GAAUF,MAAM,SAClB,KACCwB,OAAM,QAAS,EAIdQ,EAAcC,IAClB,MAAMC,EAAO,IAAIpB,KAAKmB,GACtB,MAAO,GAAGC,EAAKC,iBAAiBC,OAAOF,EAAKG,WAAa,GAAGC,SAAS,EAAG,QAAQF,OAAOF,EAAKK,WAAWD,SAAS,EAAG,QAAQF,OAAOF,EAAKM,YAAYF,SAAS,EAAG,QAAQF,OAAOF,EAAKO,cAAcH,SAAS,EAAG,MAAM,EAI/MI,EAAiB9E,IACrB,OAAQA,GACN,KAAK,EAAG,MAAO,OACf,KAAK,EAAG,MAAO,UACf,KAAK,EAAG,MAAO,SACf,QAAS,MAAO,OAClB,EAII+E,EAAiB/E,IACrB,OAAQA,GACN,KAAK,EAAG,MAAO,MACf,KAAK,EAAG,MAAO,MACf,KAAK,EAAG,MAAO,MACf,QAAS,MAAO,KAClB,E,OAGFgF,EAAAA,EAAAA,KAAU,KACRrD,IACAY,GAAe,I,ioSCxgBjB,MAAM0C,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://tcr-system-frontend/./src/views/admin/CourseManagement.vue","webpack://tcr-system-frontend/./src/views/admin/CourseManagement.vue?6ceb"],"sourcesContent":["<!-- eslint-disable vue/multi-word-component-names -->\r\n<template>\r\n  <div class=\"course-management\">\r\n    <h1>课程管理</h1>\r\n    \r\n    <el-card class=\"filter-card\">\r\n      <div class=\"filter-container\">\r\n        <el-form :inline=\"true\" :model=\"queryParams\" class=\"demo-form-inline\">\r\n          <el-form-item label=\"课程名称\">\r\n            <el-input v-model=\"queryParams.name\" placeholder=\"请输入课程名称\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"教师\">\r\n            <el-select \r\n              v-model=\"queryParams.teacherId\" \r\n              placeholder=\"请选择教师\" \r\n              clearable\r\n              v-bind=\"safeElementConfig\"\r\n            >\r\n              <el-option\r\n                v-for=\"teacher in teacherList\"\r\n                :key=\"teacher.id\"\r\n                :label=\"teacher.realName\"\r\n                :value=\"teacher.id\"\r\n              ></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item label=\"状态\">\r\n            <el-select \r\n              v-model=\"queryParams.status\" \r\n              placeholder=\"请选择状态\" \r\n              clearable\r\n              v-bind=\"safeElementConfig\"\r\n            >\r\n              <el-option label=\"未开始\" :value=\"0\"></el-option>\r\n              <el-option label=\"进行中\" :value=\"1\"></el-option>\r\n              <el-option label=\"已结束\" :value=\"2\"></el-option>\r\n            </el-select>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button type=\"primary\" @click=\"fetchCourses\">查询</el-button>\r\n            <el-button @click=\"resetQuery\">重置</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n      \r\n      <div class=\"operation-container\">\r\n        <el-button type=\"primary\" @click=\"handleAdd\">添加课程</el-button>\r\n      </div>\r\n    </el-card>\r\n    \r\n    <el-card class=\"table-card\">\r\n      <el-table :data=\"courseList\" style=\"width: 100%\" v-loading=\"loading\">\r\n        <el-table-column prop=\"id\" label=\"ID\" width=\"80\"></el-table-column>\r\n        <el-table-column prop=\"name\" label=\"课程名称\" width=\"200\"></el-table-column>\r\n        <el-table-column prop=\"teacherName\" label=\"任课教师\" width=\"150\"></el-table-column>\r\n        <el-table-column prop=\"classTime\" label=\"上课时间\" width=\"150\"></el-table-column>\r\n        <el-table-column prop=\"classLocation\" label=\"上课地点\" width=\"150\"></el-table-column>\r\n        <el-table-column label=\"结课方式\" width=\"120\">\r\n          <template #default=\"scope\">\r\n            {{ scope.row.endForm === 0 ? '考试' : '大作业' }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"结课时间\" width=\"180\">\r\n          <template #default=\"scope\">\r\n            {{ scope.row.endTime ? formatDate(scope.row.endTime) : '-' }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"endLocation\" label=\"考试地点\" width=\"150\"></el-table-column>\r\n        <el-table-column label=\"状态\" width=\"100\">\r\n          <template #default=\"scope\">\r\n            <el-tag :type=\"getStatusType(scope.row.status)\">{{ getStatusText(scope.row.status) }}</el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\" fixed=\"right\" width=\"220\">\r\n          <template #default=\"scope\">\r\n            <el-button type=\"primary\" size=\"small\" @click=\"handleEdit(scope.row)\">编辑</el-button>\r\n            <el-button type=\"success\" size=\"small\" @click=\"handleDetail(scope.row)\">详情</el-button>\r\n            <el-button type=\"danger\" size=\"small\" @click=\"handleDelete(scope.row)\">删除</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      \r\n      <div class=\"pagination-container\">\r\n        <el-pagination\r\n          :current-page=\"queryParams.pageNum\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          :page-size=\"queryParams.pageSize\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"total\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n        ></el-pagination>\r\n      </div>\r\n    </el-card>\r\n    \r\n    <!-- 课程编辑对话框 -->\r\n    <el-dialog \r\n      :title=\"dialogTitle\" \r\n      v-model=\"dialogVisible\" \r\n      width=\"650px\"\r\n      v-bind=\"safeElementConfig\"\r\n    >\r\n      <el-form :model=\"courseForm\" :rules=\"courseRules\" ref=\"courseFormRef\" label-width=\"100px\">\r\n        <el-form-item label=\"课程名称\" prop=\"name\">\r\n          <el-input v-model=\"courseForm.name\" placeholder=\"请输入课程名称\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"课程描述\" prop=\"description\">\r\n          <el-input type=\"textarea\" v-model=\"courseForm.description\" placeholder=\"请输入课程描述\" rows=\"3\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"任课教师\" prop=\"teacherId\">\r\n          <el-select \r\n            v-model=\"courseForm.teacherId\" \r\n            placeholder=\"请选择任课教师\" \r\n            style=\"width: 100%\"\r\n            v-bind=\"safeElementConfig\"\r\n          >\r\n            <el-option\r\n              v-for=\"teacher in teacherList\"\r\n              :key=\"teacher.id\"\r\n              :label=\"teacher.realName\"\r\n              :value=\"teacher.id\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"上课时间\" prop=\"classTime\">\r\n          <el-input v-model=\"courseForm.classTime\" placeholder=\"例如：周一 8:00-9:40\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"上课地点\" prop=\"classLocation\">\r\n          <el-input v-model=\"courseForm.classLocation\" placeholder=\"例如：教学楼A-101\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"结课形式\" prop=\"endForm\">\r\n          <el-radio-group v-model=\"courseForm.endForm\">\r\n            <el-radio :label=\"0\">考试</el-radio>\r\n            <el-radio :label=\"1\">大作业</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label=\"结课时间\" prop=\"endTime\">\r\n          <el-date-picker\r\n            v-model=\"courseForm.endTime\"\r\n            type=\"datetime\"\r\n            placeholder=\"选择结课时间\"\r\n            style=\"width: 100%\"\r\n            v-bind=\"safeElementConfig\"\r\n          ></el-date-picker>\r\n        </el-form-item>\r\n        <el-form-item label=\"考试地点\" prop=\"endLocation\" v-if=\"courseForm.endForm === 0\">\r\n          <el-input v-model=\"courseForm.endLocation\" placeholder=\"例如：教学楼C-203\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"课程状态\" prop=\"status\">\r\n          <el-radio-group v-model=\"courseForm.status\">\r\n            <el-radio :label=\"0\">未开始</el-radio>\r\n            <el-radio :label=\"1\">进行中</el-radio>\r\n            <el-radio :label=\"2\">已结束</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"dialogVisible = false\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"submitCourseForm\">确定</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n    \r\n    <!-- 课程详情对话框 -->\r\n    <el-dialog \r\n      title=\"课程详情\" \r\n      v-model=\"detailDialogVisible\" \r\n      width=\"800px\"\r\n      v-bind=\"safeElementConfig\"\r\n    >\r\n      <template v-if=\"courseDetail\">\r\n        <div class=\"detail-header\">\r\n          <h2>{{ courseDetail.course.name }}</h2>\r\n          <el-tag :type=\"getStatusType(courseDetail.course.status)\">{{ getStatusText(courseDetail.course.status) }}</el-tag>\r\n        </div>\r\n        \r\n        <div class=\"detail-info\">\r\n          <div class=\"info-item\">\r\n            <label>课程ID：</label>\r\n            <span>{{ courseDetail.course.id }}</span>\r\n          </div>\r\n          <div class=\"info-item\">\r\n            <label>课程描述：</label>\r\n            <span>{{ courseDetail.course.description || '无' }}</span>\r\n          </div>\r\n          <div class=\"info-item\">\r\n            <label>任课教师：</label>\r\n            <span>{{ courseDetail.teacher ? courseDetail.teacher.realName : '未知' }}</span>\r\n          </div>\r\n          <div class=\"info-item\">\r\n            <label>上课时间：</label>\r\n            <span>{{ courseDetail.course.classTime || '未设置' }}</span>\r\n          </div>\r\n          <div class=\"info-item\">\r\n            <label>上课地点：</label>\r\n            <span>{{ courseDetail.course.classLocation || '未设置' }}</span>\r\n          </div>\r\n          <div class=\"info-item\">\r\n            <label>结课形式：</label>\r\n            <span>{{ courseDetail.course.endForm === 0 ? '考试' : '大作业' }}</span>\r\n          </div>\r\n          <div class=\"info-item\">\r\n            <label>结课时间：</label>\r\n            <span>{{ courseDetail.course.endTime ? formatDate(courseDetail.course.endTime) : '未设置' }}</span>\r\n          </div>\r\n          <div class=\"info-item\" v-if=\"courseDetail.course.endForm === 0\">\r\n            <label>考试地点：</label>\r\n            <span>{{ courseDetail.course.endLocation || '未设置' }}</span>\r\n          </div>\r\n        </div>\r\n        \r\n        <el-divider content-position=\"left\">选课学生</el-divider>\r\n        \r\n        <div class=\"student-list\">\r\n          <el-table :data=\"courseDetail.students\" style=\"width: 100%\">\r\n            <el-table-column prop=\"id\" label=\"ID\" width=\"80\"></el-table-column>\r\n            <el-table-column prop=\"username\" label=\"学号\" width=\"150\"></el-table-column>\r\n            <el-table-column prop=\"realName\" label=\"姓名\" width=\"150\"></el-table-column>\r\n            <el-table-column prop=\"email\" label=\"邮箱\"></el-table-column>\r\n            <el-table-column prop=\"phone\" label=\"手机号\"></el-table-column>\r\n            <el-table-column label=\"操作\" width=\"120\">\r\n              <template #default=\"scope\">\r\n                <el-button type=\"danger\" size=\"small\" @click=\"handleRemoveStudent(scope.row)\">移除</el-button>\r\n              </template>\r\n            </el-table-column>\r\n          </el-table>\r\n        </div>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, nextTick } from 'vue'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport axios from 'axios'\r\nimport { safeElementConfig } from '@/utils/resizeObserverFix'\r\n\r\n// 查询参数\r\nconst queryParams = reactive({\r\n  pageNum: 1,\r\n  pageSize: 10,\r\n  name: '',\r\n  teacherId: null,\r\n  status: null\r\n})\r\n\r\n// 课程列表\r\nconst courseList = ref([])\r\n// 教师列表\r\nconst teacherList = ref([])\r\n// 总数据条数\r\nconst total = ref(0)\r\n// 加载状态\r\nconst loading = ref(false)\r\n\r\n// 对话框相关\r\nconst dialogVisible = ref(false)\r\nconst dialogTitle = ref('')\r\nconst dialogType = ref('add') // add or edit\r\nconst courseFormRef = ref(null)\r\nconst courseForm = reactive({\r\n  id: undefined,\r\n  name: '',\r\n  description: '',\r\n  teacherId: null,\r\n  classTime: '',\r\n  classLocation: '',\r\n  endTime: null,\r\n  endForm: 0,\r\n  endLocation: '',\r\n  status: 1\r\n})\r\n\r\n// 课程表单验证规则\r\nconst courseRules = {\r\n  name: [\r\n    { required: true, message: '请输入课程名称', trigger: 'blur' },\r\n    { min: 2, max: 100, message: '长度在 2 到 100 个字符', trigger: 'blur' }\r\n  ],\r\n  teacherId: [\r\n    { required: true, message: '请选择任课教师', trigger: 'change' }\r\n  ],\r\n  classTime: [\r\n    { required: true, message: '请输入上课时间', trigger: 'blur' }\r\n  ],\r\n  classLocation: [\r\n    { required: true, message: '请输入上课地点', trigger: 'blur' }\r\n  ],\r\n  endTime: [\r\n    { required: true, message: '请选择结课时间', trigger: 'change' }\r\n  ],\r\n  endLocation: [\r\n    { required: true, message: '请输入考试地点', trigger: 'blur' }\r\n  ]\r\n}\r\n\r\n// 课程详情对话框\r\nconst detailDialogVisible = ref(false)\r\nconst courseDetail = ref(null)\r\n\r\n// 获取课程列表\r\nconst fetchCourses = async () => {\r\n  loading.value = true\r\n  try {\r\n    const response = await axios.get('/api/admin/course-management/list', {\r\n      params: queryParams\r\n    })\r\n    if (response.data.code === 200) {\r\n      courseList.value = response.data.data.records\r\n      total.value = response.data.data.total\r\n    }\r\n  } catch (error) {\r\n    console.error('获取课程列表失败:', error)\r\n    ElMessage.error('获取课程列表失败')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 获取教师列表\r\nconst fetchTeachers = async () => {\r\n  try {\r\n    const response = await axios.get('/api/admin/course-management/available-teachers')\r\n    if (response.data.code === 200) {\r\n      teacherList.value = response.data.data\r\n    }\r\n  } catch (error) {\r\n    console.error('获取教师列表失败:', error)\r\n    ElMessage.error('获取教师列表失败')\r\n  }\r\n}\r\n\r\n// 重置查询条件\r\nconst resetQuery = () => {\r\n  queryParams.name = ''\r\n  queryParams.teacherId = null\r\n  queryParams.status = null\r\n  fetchCourses()\r\n}\r\n\r\n// 处理页码变化\r\nconst handleCurrentChange = (val) => {\r\n  queryParams.pageNum = val\r\n  fetchCourses()\r\n}\r\n\r\n// 处理每页条数变化\r\nconst handleSizeChange = (val) => {\r\n  queryParams.pageSize = val\r\n  fetchCourses()\r\n}\r\n\r\n// 处理添加课程\r\nconst handleAdd = () => {\r\n  dialogType.value = 'add'\r\n  dialogTitle.value = '添加课程'\r\n  courseForm.id = undefined\r\n  courseForm.name = ''\r\n  courseForm.description = ''\r\n  courseForm.teacherId = null\r\n  courseForm.classTime = ''\r\n  courseForm.classLocation = ''\r\n  courseForm.endTime = null\r\n  courseForm.endForm = 0\r\n  courseForm.endLocation = ''\r\n  courseForm.status = 1\r\n  \r\n  // 使用nextTick确保DOM已更新\r\n  nextTick(() => {\r\n    dialogVisible.value = true\r\n    // 等待DOM更新后再重置表单\r\n    setTimeout(() => {\r\n      courseFormRef.value && courseFormRef.value.resetFields()\r\n    }, 0)\r\n  })\r\n}\r\n\r\n// 处理编辑课程\r\nconst handleEdit = (row) => {\r\n  dialogType.value = 'edit'\r\n  dialogTitle.value = '编辑课程'\r\n  courseForm.id = row.id\r\n  courseForm.name = row.name\r\n  courseForm.description = row.description\r\n  courseForm.teacherId = row.teacherId\r\n  courseForm.classTime = row.classTime\r\n  courseForm.classLocation = row.classLocation\r\n  courseForm.endTime = row.endTime ? new Date(row.endTime) : null\r\n  courseForm.endForm = row.endForm\r\n  courseForm.endLocation = row.endLocation\r\n  courseForm.status = row.status\r\n  \r\n  // 使用nextTick确保DOM已更新\r\n  nextTick(() => {\r\n    dialogVisible.value = true\r\n  })\r\n}\r\n\r\n// 处理查看详情\r\nconst handleDetail = async (row) => {\r\n  try {\r\n    loading.value = true\r\n    const response = await axios.get(`/api/admin/course-management/${row.id}/detail`)\r\n    if (response.data.code === 200) {\r\n      // 先清空旧数据，避免显示上一次的内容\r\n      courseDetail.value = null\r\n      \r\n      // 使用nextTick确保DOM已更新\r\n      await nextTick()\r\n      \r\n      // 设置新数据\r\n      courseDetail.value = response.data.data\r\n      detailDialogVisible.value = true\r\n    }\r\n  } catch (error) {\r\n    console.error('获取课程详情失败:', error)\r\n    ElMessage.error('获取课程详情失败')\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 处理删除课程\r\nconst handleDelete = (row) => {\r\n  ElMessageBox.confirm(`确定要删除课程\"${row.name}\"吗？`, '提示', {\r\n    confirmButtonText: '确定',\r\n    cancelButtonText: '取消',\r\n    type: 'warning'\r\n  }).then(async () => {\r\n    try {\r\n      const response = await axios.delete(`/api/admin/course-management/${row.id}`)\r\n      if (response.data.code === 200) {\r\n        ElMessage.success('删除成功')\r\n        fetchCourses()\r\n      } else {\r\n        ElMessage.error(response.data.message || '删除失败')\r\n      }\r\n    } catch (error) {\r\n      console.error('删除课程失败:', error)\r\n      ElMessage.error('删除课程失败')\r\n    }\r\n  }).catch(() => {})\r\n}\r\n\r\n// 提交课程表单\r\nconst submitCourseForm = () => {\r\n  courseFormRef.value.validate(async (valid) => {\r\n    if (valid) {\r\n      try {\r\n        let response\r\n        if (dialogType.value === 'add') {\r\n          response = await axios.post('/api/admin/course-management', courseForm)\r\n        } else {\r\n          response = await axios.put('/api/admin/course-management', courseForm)\r\n        }\r\n        \r\n        if (response.data.code === 200) {\r\n          ElMessage.success(dialogType.value === 'add' ? '添加成功' : '修改成功')\r\n          dialogVisible.value = false\r\n          fetchCourses()\r\n        } else {\r\n          ElMessage.error(response.data.message || (dialogType.value === 'add' ? '添加失败' : '修改失败'))\r\n        }\r\n      } catch (error) {\r\n        console.error(dialogType.value === 'add' ? '添加课程失败:' : '修改课程失败:', error)\r\n        ElMessage.error(dialogType.value === 'add' ? '添加课程失败' : '修改课程失败')\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n// 处理移除学生\r\nconst handleRemoveStudent = (student) => {\r\n  if (!courseDetail.value || !courseDetail.value.course) return\r\n  \r\n  ElMessageBox.confirm(`确定要将学生\"${student.realName}\"从课程中移除吗？`, '提示', {\r\n    confirmButtonText: '确定',\r\n    cancelButtonText: '取消',\r\n    type: 'warning'\r\n  }).then(async () => {\r\n    try {\r\n      const response = await axios.delete(`/api/admin/course-management/${courseDetail.value.course.id}/student/${student.id}`)\r\n      if (response.data.code === 200) {\r\n        ElMessage.success('移除成功')\r\n        // 重新加载课程详情\r\n        handleDetail(courseDetail.value.course)\r\n      } else {\r\n        ElMessage.error(response.data.message || '移除失败')\r\n      }\r\n    } catch (error) {\r\n      console.error('移除学生失败:', error)\r\n      ElMessage.error('移除学生失败')\r\n    }\r\n  }).catch(() => {})\r\n}\r\n\r\n// 格式化日期\r\nconst formatDate = (dateString) => {\r\n  const date = new Date(dateString)\r\n  return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`\r\n}\r\n\r\n// 获取状态标签类型\r\nconst getStatusType = (status) => {\r\n  switch (status) {\r\n    case 0: return 'info'\r\n    case 1: return 'success'\r\n    case 2: return 'danger'\r\n    default: return 'info'\r\n  }\r\n}\r\n\r\n// 获取状态文本\r\nconst getStatusText = (status) => {\r\n  switch (status) {\r\n    case 0: return '未开始'\r\n    case 1: return '进行中'\r\n    case 2: return '已结束'\r\n    default: return '未知'\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  fetchCourses()\r\n  fetchTeachers()\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.course-management {\r\n  h1 {\r\n    margin-bottom: 20px;\r\n  }\r\n  \r\n  .filter-card {\r\n    margin-bottom: 20px;\r\n  }\r\n  \r\n  .operation-container {\r\n    margin-top: 20px;\r\n    display: flex;\r\n    justify-content: flex-end;\r\n  }\r\n  \r\n  .table-card {\r\n    margin-bottom: 20px;\r\n  }\r\n  \r\n  .pagination-container {\r\n    margin-top: 20px;\r\n    display: flex;\r\n    justify-content: flex-end;\r\n  }\r\n  \r\n  .detail-header {\r\n    display: flex;\r\n    align-items: center;\r\n    margin-bottom: 20px;\r\n    \r\n    h2 {\r\n      margin: 0;\r\n      margin-right: 10px;\r\n    }\r\n  }\r\n  \r\n  .detail-info {\r\n    margin-bottom: 20px;\r\n    \r\n    .info-item {\r\n      margin-bottom: 10px;\r\n      \r\n      label {\r\n        font-weight: bold;\r\n        margin-right: 5px;\r\n      }\r\n    }\r\n  }\r\n  \r\n  .student-list {\r\n    margin-top: 20px;\r\n  }\r\n}\r\n</style> ","import script from \"./CourseManagement.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./CourseManagement.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./CourseManagement.vue?vue&type=style&index=0&id=88a34908&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-88a34908\"]])\n\nexport default __exports__"],"names":["queryParams","reactive","pageNum","pageSize","name","teacherId","status","courseList","ref","teacherList","total","loading","dialogVisible","dialogTitle","dialogType","courseFormRef","courseForm","id","undefined","description","classTime","classLocation","endTime","endForm","endLocation","courseRules","required","message","trigger","min","max","detailDialogVisible","courseDetail","fetchCourses","async","value","response","axios","params","data","code","records","error","console","ElMessage","fetchTeachers","resetQuery","handleCurrentChange","val","handleSizeChange","handleAdd","nextTick","setTimeout","resetFields","handleEdit","row","Date","handleDetail","handleDelete","ElMessageBox","confirm","confirmButtonText","cancelButtonText","type","then","success","catch","submitCourseForm","validate","valid","handleRemoveStudent","student","course","realName","formatDate","dateString","date","getFullYear","String","getMonth","padStart","getDate","getHours","getMinutes","getStatusType","getStatusText","onMounted","__exports__"],"sourceRoot":""}