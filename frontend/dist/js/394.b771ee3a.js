"use strict";(self["webpackChunktcr_system_frontend"]=self["webpackChunktcr_system_frontend"]||[]).push([[394],{3394:function(e,a,l){l.r(a),l.d(a,{default:function(){return v}});var t=l(6768),o=l(4232),r=l(144),d=l(1219),u=l(2933),n=l(788),s=l.n(n),i=l(1576),c=l.n(i);const m={class:"course-management"},p={class:"filter-container"},b={class:"pagination-container"},g={class:"dialog-footer"};var f={__name:"CourseManagement",setup(e){const a=(0,r.Kh)({pageNum:1,pageSize:10,name:"",status:""}),l=(0,r.KR)([]),n=(0,r.KR)([]),i=(0,r.KR)(0),f=(0,r.KR)(!1),k=(0,r.KR)(!1),F=(0,r.KR)("add"),v=(0,r.KR)(null),h=(0,r.Kh)({id:null,name:"",description:"",classTime:"",classLocation:"",endTime:"",endForm:0,endLocation:"",status:1}),_={name:[{required:!0,message:"请输入课程名称",trigger:"blur"}],description:[{required:!0,message:"请输入课程描述",trigger:"blur"}],classTime:[{required:!0,message:"请输入上课时间",trigger:"blur"}],classLocation:[{required:!0,message:"请输入上课地点",trigger:"blur"}],endTime:[{required:!0,message:"请选择结课时间",trigger:"change"}],endForm:[{required:!0,message:"请选择结课形式",trigger:"change"}],status:[{required:!0,message:"请选择课程状态",trigger:"change"}]},w=async()=>{f.value=!0;try{const e=JSON.parse(localStorage.getItem("userInfo")||"{}"),t=e.id;if(!t)return void d.nk.warning("获取用户信息失败，请重新登录");const o={pageNum:a.pageNum,pageSize:a.pageSize,name:a.name,status:""!==a.status?Number(a.status):null};console.log("查询参数:",o);const r=await s().get(`/api/course/teacher/${t}/page`,{params:o});if(200===r.data.code){const e=r.data.data;l.value=e.records||[],i.value=e.total||0,0===n.value.length&&V(t)}else d.nk.error(r.data.message||"获取课程列表失败")}catch(e){console.error("获取课程列表失败:",e),d.nk.error("获取课程列表失败")}finally{f.value=!1}},V=async e=>{try{const a=await s().get(`/api/course/teacher/${e}`);if(200===a.data.code){const e=a.data.data||[];n.value=Array.from(new Set(e.map((e=>e.name)))).map((e=>({name:e}))),console.log("课程筛选选项:",n.value)}}catch(a){console.error("获取课程选项失败:",a)}},y=()=>{a.name="",a.status="",w()},C=e=>{a.pageSize=e,w()},L=e=>{a.pageNum=e,w()},T=e=>{z(),F.value="edit",Object.assign(h,e),k.value=!0},W=e=>{u.s.confirm("确定要删除该课程吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{const a=await s()["delete"](`/api/course/${e.id}`);200===a.data.code?(d.nk.success("删除成功"),w()):d.nk.error(a.data.message||"删除失败")}catch(a){console.error("删除失败:",a),d.nk.error("删除失败")}})).catch((()=>{}))},z=()=>{h.id=null,h.name="",h.description="",h.classTime="",h.classLocation="",h.endTime="",h.endForm=0,h.endLocation="",h.status=1,v.value&&v.value.resetFields()},Y=()=>{v.value.validate((async e=>{if(e)try{const e=(F.value,"/api/course"),a="add"===F.value?"post":"put",l=await s()[a](e,h);200===l.data.code?(d.nk.success("add"===F.value?"添加成功":"修改成功"),k.value=!1,w()):d.nk.error(l.data.message||("add"===F.value?"添加失败":"修改失败"))}catch(a){console.error("add"===F.value?"添加失败:":"修改失败:",a),d.nk.error("add"===F.value?"添加失败":"修改失败")}}))},U=e=>e?c()(e).format("YYYY-MM-DD HH:mm"):"未设置",K=e=>{switch(e){case 0:return"考试";case 1:return"大作业";default:return"未设置"}},x=e=>{switch(e){case 0:return"danger";case 1:return"success";case 2:return"info";default:return""}},S=e=>{switch(e){case 0:return"未开始";case 1:return"进行中";case 2:return"已结束";default:return"未知"}};return(0,t.sV)((()=>{w()})),(e,r)=>{const d=(0,t.g2)("el-option"),u=(0,t.g2)("el-select"),s=(0,t.g2)("el-form-item"),c=(0,t.g2)("el-button"),V=(0,t.g2)("el-form"),z=(0,t.g2)("el-card"),N=(0,t.g2)("el-table-column"),R=(0,t.g2)("el-tag"),q=(0,t.g2)("el-table"),M=(0,t.g2)("el-pagination"),D=(0,t.g2)("el-input"),H=(0,t.g2)("el-date-picker"),X=(0,t.g2)("el-radio"),I=(0,t.g2)("el-radio-group"),A=(0,t.g2)("el-dialog"),$=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",m,[r[20]||(r[20]=(0,t.Lk)("h1",null,"课程管理",-1)),(0,t.bF)(z,{class:"filter-card"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",p,[(0,t.bF)(V,{inline:!0,model:a,class:"demo-form-inline"},{default:(0,t.k6)((()=>[(0,t.bF)(s,{label:"课程名称"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:a.name,"onUpdate:modelValue":r[0]||(r[0]=e=>a.name=e),placeholder:"选择课程",clearable:"",filterable:"",style:{width:"220px"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(n.value,(e=>((0,t.uX)(),(0,t.Wv)(d,{key:e.name,label:e.name,value:e.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"状态"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:a.status,"onUpdate:modelValue":r[1]||(r[1]=e=>a.status=e),placeholder:"选择状态",clearable:"",style:{width:"150px"}},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"未开始",value:0}),(0,t.bF)(d,{label:"进行中",value:1}),(0,t.bF)(d,{label:"已结束",value:2})])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(s,null,{default:(0,t.k6)((()=>[(0,t.bF)(c,{type:"primary",onClick:w},{default:(0,t.k6)((()=>r[12]||(r[12]=[(0,t.eW)("查询")]))),_:1}),(0,t.bF)(c,{onClick:y},{default:(0,t.k6)((()=>r[13]||(r[13]=[(0,t.eW)("重置")]))),_:1})])),_:1})])),_:1},8,["model"])])])),_:1}),(0,t.bF)(z,{class:"course-list-card"},{default:(0,t.k6)((()=>[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(q,{data:l.value,style:{width:"100%"}},{default:(0,t.k6)((()=>[(0,t.bF)(N,{prop:"name",label:"课程名称",width:"180"}),(0,t.bF)(N,{prop:"description",label:"课程描述","show-overflow-tooltip":""}),(0,t.bF)(N,{prop:"classTime",label:"上课时间",width:"150"}),(0,t.bF)(N,{prop:"classLocation",label:"上课地点",width:"150"}),(0,t.bF)(N,{label:"结课时间",width:"170"},{default:(0,t.k6)((e=>[(0,t.eW)((0,o.v_)(U(e.row.endTime)),1)])),_:1}),(0,t.bF)(N,{label:"结课形式",width:"100"},{default:(0,t.k6)((e=>[(0,t.eW)((0,o.v_)(K(e.row.endForm)),1)])),_:1}),(0,t.bF)(N,{prop:"endLocation",label:"结课地点",width:"150"}),(0,t.bF)(N,{label:"状态",width:"100"},{default:(0,t.k6)((e=>[(0,t.bF)(R,{type:x(e.row.status)},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(S(e.row.status)),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(N,{label:"操作",width:"200",fixed:"right"},{default:(0,t.k6)((e=>[(0,t.bF)(c,{type:"primary",size:"small",onClick:a=>T(e.row)},{default:(0,t.k6)((()=>r[14]||(r[14]=[(0,t.eW)("编辑")]))),_:2},1032,["onClick"]),(0,t.bF)(c,{type:"danger",size:"small",onClick:a=>W(e.row)},{default:(0,t.k6)((()=>r[15]||(r[15]=[(0,t.eW)("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[$,f.value]]),(0,t.Lk)("div",b,[(0,t.bF)(M,{"current-page":a.pageNum,"page-size":a.pageSize,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:i.value,onSizeChange:C,onCurrentChange:L},null,8,["current-page","page-size","total"])])])),_:1}),(0,t.bF)(A,{modelValue:k.value,"onUpdate:modelValue":r[11]||(r[11]=e=>k.value=e),title:"add"===F.value?"添加课程":"编辑课程",width:"600px","append-to-body":""},{footer:(0,t.k6)((()=>[(0,t.Lk)("div",g,[(0,t.bF)(c,{onClick:r[10]||(r[10]=e=>k.value=!1)},{default:(0,t.k6)((()=>r[18]||(r[18]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(c,{type:"primary",onClick:Y},{default:(0,t.k6)((()=>r[19]||(r[19]=[(0,t.eW)("确认")]))),_:1})])])),default:(0,t.k6)((()=>[(0,t.bF)(V,{ref_key:"courseFormRef",ref:v,model:h,rules:_,"label-width":"120px"},{default:(0,t.k6)((()=>[(0,t.bF)(s,{label:"课程名称",prop:"name"},{default:(0,t.k6)((()=>[(0,t.bF)(D,{modelValue:h.name,"onUpdate:modelValue":r[2]||(r[2]=e=>h.name=e),placeholder:"请输入课程名称"},null,8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"课程描述",prop:"description"},{default:(0,t.k6)((()=>[(0,t.bF)(D,{modelValue:h.description,"onUpdate:modelValue":r[3]||(r[3]=e=>h.description=e),type:"textarea",rows:3,placeholder:"请输入课程描述"},null,8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"上课时间",prop:"classTime"},{default:(0,t.k6)((()=>[(0,t.bF)(D,{modelValue:h.classTime,"onUpdate:modelValue":r[4]||(r[4]=e=>h.classTime=e),placeholder:"例如：周一 8:00-9:40"},null,8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"上课地点",prop:"classLocation"},{default:(0,t.k6)((()=>[(0,t.bF)(D,{modelValue:h.classLocation,"onUpdate:modelValue":r[5]||(r[5]=e=>h.classLocation=e),placeholder:"例如：教学楼A-101"},null,8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"结课时间",prop:"endTime"},{default:(0,t.k6)((()=>[(0,t.bF)(H,{modelValue:h.endTime,"onUpdate:modelValue":r[6]||(r[6]=e=>h.endTime=e),type:"datetime",placeholder:"选择结课时间",format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,t.bF)(s,{label:"结课形式",prop:"endForm"},{default:(0,t.k6)((()=>[(0,t.bF)(I,{modelValue:h.endForm,"onUpdate:modelValue":r[7]||(r[7]=e=>h.endForm=e)},{default:(0,t.k6)((()=>[(0,t.bF)(X,{label:0},{default:(0,t.k6)((()=>r[16]||(r[16]=[(0,t.eW)("考试")]))),_:1}),(0,t.bF)(X,{label:1},{default:(0,t.k6)((()=>r[17]||(r[17]=[(0,t.eW)("大作业")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),0===h.endForm?((0,t.uX)(),(0,t.Wv)(s,{key:0,label:"结课地点",prop:"endLocation"},{default:(0,t.k6)((()=>[(0,t.bF)(D,{modelValue:h.endLocation,"onUpdate:modelValue":r[8]||(r[8]=e=>h.endLocation=e),placeholder:"例如：教学楼C-201"},null,8,["modelValue"])])),_:1})):(0,t.Q3)("",!0),(0,t.bF)(s,{label:"课程状态",prop:"status"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:h.status,"onUpdate:modelValue":r[9]||(r[9]=e=>h.status=e),placeholder:"请选择课程状态"},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"未开始",value:0}),(0,t.bF)(d,{label:"进行中",value:1}),(0,t.bF)(d,{label:"已结束",value:2})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])])}}},k=l(1241);const F=(0,k.A)(f,[["__scopeId","data-v-27991a54"]]);var v=F}}]);
//# sourceMappingURL=394.b771ee3a.js.map