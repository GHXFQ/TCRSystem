{"version":3,"file":"js/390.898b95d7.js","mappings":"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","sources":["webpack://tcr-system-frontend/./src/views/teacher/AssignmentSubmissions.vue","webpack://tcr-system-frontend/./src/views/teacher/AssignmentSubmissions.vue?b1e8"],"sourcesContent":["<template>\r\n  <div class=\"assignment-submissions-container\">\r\n    <div class=\"page-header\">\r\n      <div class=\"title-section\">\r\n        <el-button @click=\"goBack\" icon=\"ArrowLeft\" circle plain></el-button>\r\n        <h1>{{ title || '作业提交列表' }}</h1>\r\n      </div>\r\n      <div class=\"info-section\" v-if=\"assignmentInfo\">\r\n        <el-tag :type=\"getStatusType(assignmentInfo.status)\">{{ getStatusText(assignmentInfo.status) }}</el-tag>\r\n        <span>所属课程: {{ assignmentInfo.courseName }}</span>\r\n        <span>截止时间: {{ assignmentInfo.deadline }}</span>\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- 统计卡片 -->\r\n    <el-card class=\"statistics-card\" v-if=\"statistics\">\r\n      <div class=\"statistics-row\">\r\n        <div class=\"stat-box\">\r\n          <div class=\"stat-value\">{{ statistics.totalStudents || 0 }}</div>\r\n          <div class=\"stat-label\">学生总数</div>\r\n        </div>\r\n        <div class=\"stat-box\">\r\n          <div class=\"stat-value\">{{ statistics.submittedCount || 0 }}</div>\r\n          <div class=\"stat-label\">已提交</div>\r\n        </div>\r\n        <div class=\"stat-box\">\r\n          <div class=\"stat-value\">{{ statistics.submissionRate || '0%' }}</div>\r\n          <div class=\"stat-label\">提交率</div>\r\n        </div>\r\n        <div class=\"stat-box\">\r\n          <div class=\"stat-value\">{{ statistics.gradedCount || 0 }}</div>\r\n          <div class=\"stat-label\">已批改</div>\r\n        </div>\r\n        <div class=\"stat-box\">\r\n          <div class=\"stat-value\">{{ statistics.gradingRate || '0%' }}</div>\r\n          <div class=\"stat-label\">批改率</div>\r\n        </div>\r\n        <div class=\"stat-box\">\r\n          <div class=\"stat-value\">{{ statistics.avgScore || '暂无' }}</div>\r\n          <div class=\"stat-label\">平均分</div>\r\n        </div>\r\n      </div>\r\n    </el-card>\r\n    \r\n    <!-- 过滤器 -->\r\n    <el-card class=\"filter-card\">\r\n      <el-form :inline=\"true\" :model=\"queryParams\" class=\"filter-form\">\r\n        <el-form-item label=\"状态\">\r\n          <el-select \r\n            v-model=\"queryParams.status\" \r\n            placeholder=\"选择状态\" \r\n            clearable \r\n            style=\"width: 120px;\"\r\n          >\r\n            <el-option label=\"已提交\" :value=\"0\"></el-option>\r\n            <el-option label=\"已批改\" :value=\"1\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"fetchSubmissions\">查询</el-button>\r\n          <el-button @click=\"resetQuery\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n    \r\n    <!-- 提交列表 -->\r\n    <el-card v-loading=\"loading\" class=\"submissions-card\">\r\n      <div class=\"empty-tip\" v-if=\"!submissionList.length && !loading\">\r\n        <el-empty description=\"暂无符合条件的作业提交\"></el-empty>\r\n      </div>\r\n      \r\n      <el-table \r\n        v-else \r\n        :data=\"submissionList\" \r\n        style=\"width: 100%\"\r\n        border\r\n      >\r\n        <el-table-column prop=\"studentName\" label=\"学生姓名\" width=\"120\" />\r\n        <el-table-column prop=\"studentId\" label=\"学号\" width=\"100\" />\r\n        <el-table-column prop=\"courseName\" label=\"所属课程\" width=\"150\" show-overflow-tooltip />\r\n        <el-table-column prop=\"content\" label=\"提交内容\" min-width=\"200\" show-overflow-tooltip>\r\n          <template #default=\"scope\">\r\n            <div v-if=\"scope.row.content\" class=\"submission-content\">{{ scope.row.content }}</div>\r\n            <div v-else class=\"submission-content empty\">无文本内容</div>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"fileName\" label=\"提交文件\" width=\"180\" show-overflow-tooltip>\r\n          <template #default=\"scope\">\r\n            <el-link \r\n              v-if=\"scope.row.filePath\" \r\n              :href=\"`/api/assignment/submission/download/${scope.row.id}`\" \r\n              target=\"_blank\"\r\n              type=\"primary\"\r\n            >\r\n              {{ scope.row.fileName || '下载文件' }}\r\n            </el-link>\r\n            <span v-else>无文件</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\r\n          <template #default=\"scope\">\r\n            <el-tag :type=\"getSubmissionStatusType(scope.row.status)\">\r\n              {{ getSubmissionStatusText(scope.row.status) }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"isOverdue\" label=\"是否逾期\" width=\"100\">\r\n          <template #default=\"scope\">\r\n            <el-tag :type=\"scope.row.isOverdue ? 'danger' : 'success'\" size=\"small\">\r\n              {{ scope.row.isOverdue ? '已逾期' : '按时提交' }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"score\" label=\"得分\" width=\"80\" align=\"center\">\r\n          <template #default=\"scope\">\r\n            {{ scope.row.score !== null && scope.row.score !== undefined ? scope.row.score : '未批改' }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"createTime\" label=\"提交时间\" width=\"180\" />\r\n        <el-table-column label=\"操作\" width=\"120\" fixed=\"right\">\r\n          <template #default=\"scope\">\r\n            <el-button \r\n              type=\"primary\" \r\n              size=\"small\" \r\n              plain\r\n              @click=\"openGradeDialog(scope.row)\"\r\n            >批改</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      \r\n      <div class=\"pagination-container\">\r\n        <el-pagination\r\n          background\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"total\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          :page-size=\"queryParams.pageSize\"\r\n          :current-page=\"queryParams.current\"\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n        />\r\n      </div>\r\n    </el-card>\r\n    \r\n    <!-- 批改对话框 -->\r\n    <el-dialog\r\n      v-model=\"gradeDialogVisible\"\r\n      title=\"批改作业\"\r\n      width=\"600px\"\r\n      :close-on-click-modal=\"false\"\r\n    >\r\n      <div v-if=\"currentSubmission\" class=\"grading-form\">\r\n        <div class=\"submission-info\">\r\n          <h3>提交信息</h3>\r\n          \r\n          <div class=\"info-row\">\r\n            <div class=\"info-label\">学生</div>\r\n            <div class=\"info-value\">{{ currentSubmission.studentName }} ({{ currentSubmission.studentId }})</div>\r\n          </div>\r\n          \r\n          <div class=\"info-row\">\r\n            <div class=\"info-label\">提交内容</div>\r\n            <div class=\"info-value content\">\r\n              <div v-if=\"currentSubmission.content\" class=\"content-text\">{{ currentSubmission.content }}</div>\r\n              <div v-else class=\"content-text empty\">无文本内容</div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div class=\"info-row\" v-if=\"currentSubmission.filePath\">\r\n            <div class=\"info-label\">提交文件</div>\r\n            <div class=\"info-value\">\r\n              <el-link \r\n                :href=\"`/api/assignment/submission/download/${currentSubmission.id}`\" \r\n                target=\"_blank\"\r\n                type=\"primary\"\r\n              >\r\n                {{ currentSubmission.fileName || '下载文件' }}\r\n              </el-link>\r\n            </div>\r\n          </div>\r\n          \r\n          <div class=\"info-row\">\r\n            <div class=\"info-label\">提交时间</div>\r\n            <div class=\"info-value\">\r\n              {{ currentSubmission.createTime }}\r\n              <el-tag \r\n                :type=\"currentSubmission.isOverdue ? 'danger' : 'success'\" \r\n                size=\"small\" \r\n                style=\"margin-left: 10px;\"\r\n              >\r\n                {{ currentSubmission.isOverdue ? '已逾期' : '按时提交' }}\r\n              </el-tag>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"grading-section\">\r\n          <h3>评分</h3>\r\n          \r\n          <el-form :model=\"gradeForm\" :rules=\"rules\" ref=\"gradeFormRef\" label-width=\"80px\">\r\n            <el-form-item label=\"得分\" prop=\"score\">\r\n              <el-input-number \r\n                v-model=\"gradeForm.score\" \r\n                :min=\"0\" \r\n                :max=\"assignmentInfo?.maxScore || 100\" \r\n                :step=\"1\"\r\n                style=\"width: 120px;\"\r\n              />\r\n              <span class=\"score-hint\">满分: {{ assignmentInfo?.maxScore || 100 }}</span>\r\n            </el-form-item>\r\n            \r\n            <el-form-item label=\"评语\" prop=\"comment\">\r\n              <el-input \r\n                v-model=\"gradeForm.comment\" \r\n                type=\"textarea\" \r\n                :rows=\"4\" \r\n                placeholder=\"请输入评语\" \r\n              />\r\n            </el-form-item>\r\n          </el-form>\r\n        </div>\r\n      </div>\r\n      \r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"gradeDialogVisible = false\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"submitGrade\" :loading=\"submitting\">提交评分</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, computed } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { ElMessage } from 'element-plus'\r\nimport {  } from '@element-plus/icons-vue'\r\nimport axios from 'axios'\r\n\r\nconst route = useRoute()\r\nconst router = useRouter()\r\n\r\n// 状态变量\r\nconst loading = ref(false)\r\nconst submitting = ref(false)\r\nconst submissionList = ref([])\r\nconst total = ref(0)\r\nconst assignmentInfo = ref(null)\r\nconst statistics = ref(null)\r\nconst gradeDialogVisible = ref(false)\r\nconst currentSubmission = ref(null)\r\n\r\n// 查询参数\r\nconst queryParams = reactive({\r\n  current: 1,\r\n  pageSize: 10,\r\n  assignmentId: null,\r\n  status: null\r\n})\r\n\r\n// 评分表单\r\nconst gradeFormRef = ref(null)\r\nconst gradeForm = reactive({\r\n  id: null,\r\n  score: 0,\r\n  comment: ''\r\n})\r\n\r\n// 表单校验规则\r\nconst rules = {\r\n  score: [\r\n    { required: true, message: '请输入分数', trigger: 'blur' }\r\n  ]\r\n}\r\n\r\n// 计算属性\r\nconst title = computed(() => {\r\n  return route.query.title ? `作业: ${route.query.title}` : '作业提交列表'\r\n})\r\n\r\n// 获取作业状态类型\r\nconst getStatusType = (status) => {\r\n  switch (status) {\r\n    case 0: return 'danger'   // 已关闭\r\n    case 1: return 'primary'  // 进行中\r\n    case 2: return 'success'  // 已结束\r\n    default: return 'info'\r\n  }\r\n}\r\n\r\n// 获取作业状态文本\r\nconst getStatusText = (status) => {\r\n  switch (status) {\r\n    case 0: return '已关闭'\r\n    case 1: return '进行中'\r\n    case 2: return '已结束'\r\n    default: return '未知'\r\n  }\r\n}\r\n\r\n// 获取提交状态类型\r\nconst getSubmissionStatusType = (status) => {\r\n  switch (status) {\r\n    case 0: return 'warning' // 已提交\r\n    case 1: return 'success' // 已批改\r\n    default: return 'info'\r\n  }\r\n}\r\n\r\n// 获取提交状态文本\r\nconst getSubmissionStatusText = (status) => {\r\n  switch (status) {\r\n    case 0: return '已提交'\r\n    case 1: return '已批改'\r\n    default: return '未知'\r\n  }\r\n}\r\n\r\n// 返回上一页\r\nconst goBack = () => {\r\n  router.go(-1)\r\n}\r\n\r\n// 获取作业信息\r\nconst fetchAssignmentInfo = async () => {\r\n  try {\r\n    const assignmentId = route.query.assignmentId\r\n    if (!assignmentId) {\r\n      ElMessage.warning('未指定作业ID')\r\n      return\r\n    }\r\n    \r\n    const response = await axios.get(`/api/assignment/${assignmentId}`)\r\n    if (response.data.code === 200) {\r\n      assignmentInfo.value = response.data.data\r\n    } else {\r\n      ElMessage.error(response.data.message || '获取作业信息失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('获取作业信息失败:', error)\r\n    ElMessage.error('获取作业信息失败')\r\n  }\r\n}\r\n\r\n// 获取提交统计\r\nconst fetchSubmissionStatistics = async () => {\r\n  try {\r\n    const assignmentId = route.query.assignmentId\r\n    if (!assignmentId) return\r\n    \r\n    const response = await axios.get(`/api/assignment/submission/statistics/${assignmentId}`)\r\n    if (response.data.code === 200) {\r\n      statistics.value = response.data.data\r\n    }\r\n  } catch (error) {\r\n    console.error('获取提交统计失败:', error)\r\n    ElMessage.error('获取提交统计失败')\r\n  }\r\n}\r\n\r\n// 获取提交列表\r\nconst fetchSubmissions = async () => {\r\n  loading.value = true\r\n  try {\r\n    const assignmentId = route.query.assignmentId\r\n    if (!assignmentId) {\r\n      ElMessage.warning('未指定作业ID')\r\n      loading.value = false\r\n      return\r\n    }\r\n    \r\n    queryParams.assignmentId = assignmentId\r\n    \r\n    const params = {\r\n      current: queryParams.current,\r\n      size: queryParams.pageSize,\r\n      assignmentId: queryParams.assignmentId,\r\n      status: queryParams.status\r\n    }\r\n    \r\n    const response = await axios.get('/api/assignment/submission/list', { params })\r\n    \r\n    if (response.data.code === 200) {\r\n      submissionList.value = response.data.data.records || []\r\n      total.value = response.data.data.total || 0\r\n    } else {\r\n      ElMessage.error(response.data.message || '获取提交列表失败')\r\n    }\r\n  } catch (error) {\r\n    console.error('获取提交列表失败:', error)\r\n    ElMessage.error('获取提交列表失败：' + (error.response?.data?.message || error.message))\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 重置查询\r\nconst resetQuery = () => {\r\n  queryParams.status = null\r\n  queryParams.current = 1\r\n  fetchSubmissions()\r\n}\r\n\r\n// 处理页码变化\r\nconst handleCurrentChange = (current) => {\r\n  queryParams.current = current\r\n  fetchSubmissions()\r\n}\r\n\r\n// 处理每页条数变化\r\nconst handleSizeChange = (size) => {\r\n  queryParams.pageSize = size\r\n  queryParams.current = 1\r\n  fetchSubmissions()\r\n}\r\n\r\n// 打开批改对话框\r\nconst openGradeDialog = (submission) => {\r\n  currentSubmission.value = submission\r\n  \r\n  // 初始化表单\r\n  gradeForm.id = submission.id\r\n  gradeForm.score = submission.score !== null && submission.score !== undefined ? submission.score : 0\r\n  gradeForm.comment = submission.comment || ''\r\n  \r\n  // 打开对话框\r\n  gradeDialogVisible.value = true\r\n  \r\n  // 重置表单验证\r\n  setTimeout(() => {\r\n    gradeFormRef.value?.clearValidate()\r\n  }, 0)\r\n}\r\n\r\n// 提交评分\r\nconst submitGrade = async () => {\r\n  if (!gradeFormRef.value) return\r\n  \r\n  await gradeFormRef.value.validate(async (valid) => {\r\n    if (!valid) {\r\n      return false\r\n    }\r\n    \r\n    submitting.value = true\r\n    try {\r\n      const params = {\r\n        id: gradeForm.id,\r\n        score: gradeForm.score,\r\n        comment: gradeForm.comment\r\n      }\r\n      \r\n      const response = await axios.post('/api/assignment/grade', null, { params })\r\n      \r\n      if (response.data.code === 200) {\r\n        ElMessage.success('评分提交成功')\r\n        gradeDialogVisible.value = false\r\n        \r\n        // 更新本地数据\r\n        const index = submissionList.value.findIndex(item => item.id === gradeForm.id)\r\n        if (index !== -1) {\r\n          submissionList.value[index].score = gradeForm.score\r\n          submissionList.value[index].comment = gradeForm.comment\r\n          submissionList.value[index].status = 2 // 已批改\r\n        }\r\n        \r\n        // 重新获取统计数据\r\n        fetchSubmissionStatistics()\r\n      } else {\r\n        ElMessage.error(response.data.message || '评分提交失败')\r\n      }\r\n    } catch (error) {\r\n      console.error('评分提交失败:', error)\r\n      ElMessage.error('评分提交失败：' + (error.response?.data?.message || error.message))\r\n    } finally {\r\n      submitting.value = false\r\n    }\r\n  })\r\n}\r\n\r\n// 页面加载时获取数据\r\nonMounted(async () => {\r\n  await fetchAssignmentInfo()\r\n  await fetchSubmissions()\r\n  await fetchSubmissionStatistics()\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.assignment-submissions-container {\r\n  padding: 20px;\r\n  \r\n  .page-header {\r\n    margin-bottom: 20px;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    flex-wrap: wrap;\r\n    gap: 10px;\r\n    \r\n    .title-section {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 10px;\r\n      \r\n      h1 {\r\n        margin: 0;\r\n        font-size: 22px;\r\n        font-weight: 500;\r\n        color: #303133;\r\n      }\r\n    }\r\n    \r\n    .info-section {\r\n      display: flex;\r\n      align-items: center;\r\n      gap: 15px;\r\n      color: #606266;\r\n    }\r\n  }\r\n  \r\n  .statistics-card {\r\n    margin-bottom: 20px;\r\n    \r\n    .statistics-row {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      flex-wrap: wrap;\r\n      gap: 10px;\r\n      \r\n      .stat-box {\r\n        padding: 10px 15px;\r\n        text-align: center;\r\n        flex: 1;\r\n        min-width: 100px;\r\n        \r\n        .stat-value {\r\n          font-size: 22px;\r\n          font-weight: bold;\r\n          color: #409EFF;\r\n          margin-bottom: 5px;\r\n        }\r\n        \r\n        .stat-label {\r\n          font-size: 14px;\r\n          color: #909399;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  .filter-card {\r\n    margin-bottom: 20px;\r\n  }\r\n  \r\n  .submissions-card {\r\n    .empty-tip {\r\n      padding: 30px 0;\r\n    }\r\n    \r\n    .submission-content {\r\n      max-height: 60px;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      display: -webkit-box;\r\n      -webkit-line-clamp: 3;\r\n      -webkit-box-orient: vertical;\r\n      \r\n      &.empty {\r\n        color: #909399;\r\n        font-style: italic;\r\n      }\r\n    }\r\n    \r\n    .pagination-container {\r\n      display: flex;\r\n      justify-content: flex-end;\r\n      margin-top: 20px;\r\n    }\r\n  }\r\n  \r\n  .grading-form {\r\n    .submission-info {\r\n      margin-bottom: 20px;\r\n      \r\n      h3 {\r\n        font-size: 16px;\r\n        font-weight: 500;\r\n        margin-bottom: 15px;\r\n        color: #303133;\r\n        border-bottom: 1px solid #EBEEF5;\r\n        padding-bottom: 10px;\r\n      }\r\n      \r\n      .info-row {\r\n        display: flex;\r\n        margin-bottom: 15px;\r\n        \r\n        .info-label {\r\n          width: 80px;\r\n          color: #606266;\r\n          font-weight: 500;\r\n        }\r\n        \r\n        .info-value {\r\n          flex: 1;\r\n          \r\n          &.content {\r\n            .content-text {\r\n              padding: 10px;\r\n              background-color: #f9f9f9;\r\n              border-radius: 4px;\r\n              max-height: 100px;\r\n              overflow-y: auto;\r\n              \r\n              &.empty {\r\n                color: #909399;\r\n                font-style: italic;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    .grading-section {\r\n      h3 {\r\n        font-size: 16px;\r\n        font-weight: 500;\r\n        margin-bottom: 15px;\r\n        color: #303133;\r\n        border-bottom: 1px solid #EBEEF5;\r\n        padding-bottom: 10px;\r\n      }\r\n      \r\n      .score-hint {\r\n        margin-left: 10px;\r\n        color: #909399;\r\n        font-size: 14px;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style> ","import script from \"./AssignmentSubmissions.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AssignmentSubmissions.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./AssignmentSubmissions.vue?vue&type=style&index=0&id=b7c18006&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-b7c18006\"]])\n\nexport default __exports__"],"names":["route","useRoute","router","useRouter","loading","ref","submitting","submissionList","total","assignmentInfo","statistics","gradeDialogVisible","currentSubmission","queryParams","reactive","current","pageSize","assignmentId","status","gradeFormRef","gradeForm","id","score","comment","rules","required","message","trigger","title","computed","query","getStatusType","getStatusText","getSubmissionStatusType","getSubmissionStatusText","goBack","go","fetchAssignmentInfo","async","ElMessage","warning","response","axios","data","code","value","error","console","fetchSubmissionStatistics","fetchSubmissions","params","size","records","resetQuery","handleCurrentChange","handleSizeChange","openGradeDialog","submission","undefined","setTimeout","clearValidate","submitGrade","validate","valid","success","index","findIndex","item","onMounted","__exports__"],"sourceRoot":""}