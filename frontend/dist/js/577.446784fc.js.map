{"version":3,"file":"js/577.446784fc.js","mappings":"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","sources":["webpack://tcr-system-frontend/./src/views/student/Assignments.vue","webpack://tcr-system-frontend/./src/views/student/Assignments.vue?fcb2"],"sourcesContent":["<template>\n  <div class=\"assignments-container\">\n    <h1>课程作业</h1>\n    \n    <!-- 作业统计卡片 -->\n    <el-card class=\"statistics-card\" v-if=\"courseId\">\n      <template #header>\n        <div class=\"card-header\">\n          <span>课程完成情况</span>\n          <el-tag type=\"success\" v-if=\"statistics.completionRate\">完成率: {{ statistics.completionRate }}</el-tag>\n        </div>\n      </template>\n      \n      <div class=\"statistics-row\">\n        <div class=\"stat-box\">\n          <div class=\"stat-value\">{{ statistics.totalAssignments || 0 }}</div>\n          <div class=\"stat-label\">总作业数</div>\n        </div>\n        <div class=\"stat-box\">\n          <div class=\"stat-value\">{{ statistics.submittedCount || 0 }}</div>\n          <div class=\"stat-label\">已提交数</div>\n        </div>\n        <div class=\"stat-box\">\n          <div class=\"stat-value\">{{ statistics.gradedCount || 0 }}</div>\n          <div class=\"stat-label\">已批改数</div>\n        </div>\n        <div class=\"stat-box\">\n          <div class=\"stat-value\">{{ statistics.averageScore || '暂无' }}</div>\n          <div class=\"stat-label\">平均分</div>\n        </div>\n      </div>\n    </el-card>\n    \n    <!-- 查询过滤卡片 -->\n    <el-card class=\"filter-card\">\n      <el-form :inline=\"true\" :model=\"queryParams\" class=\"filter-form\">\n        <el-form-item label=\"课程\">\n          <el-select \n            v-model=\"queryParams.courseId\" \n            placeholder=\"选择课程\" \n            clearable \n            filterable\n            style=\"width: 220px;\"\n            @change=\"handleCourseChange\"\n          >\n            <el-option\n              v-for=\"course in courseList\"\n              :key=\"course.id\"\n              :label=\"course.name\"\n              :value=\"course.id\"\n            />\n          </el-select>\n        </el-form-item>\n        \n        <el-form-item label=\"状态\">\n          <el-select \n            v-model=\"queryParams.status\" \n            placeholder=\"选择状态\" \n            clearable \n            style=\"width: 120px;\"\n          >\n            <el-option label=\"进行中\" :value=\"1\"></el-option>\n            <el-option label=\"已结束\" :value=\"2\"></el-option>\n            <el-option label=\"已关闭\" :value=\"0\"></el-option>\n          </el-select>\n        </el-form-item>\n        \n        <el-form-item>\n          <el-button type=\"primary\" @click=\"fetchAssignments\">查询</el-button>\n          <el-button @click=\"resetQuery\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n    \n    <!-- 作业列表 -->\n    <el-card v-loading=\"loading\" class=\"assignments-card\">\n      <div class=\"assignments-tip\" v-if=\"!assignmentList.length && !loading\">\n        <el-empty description=\"暂无符合条件的作业\"></el-empty>\n      </div>\n      \n      <el-table \n        v-else \n        :data=\"assignmentList\" \n        style=\"width: 100%\"\n        border\n        @row-click=\"handleRowClick\"\n      >\n        <el-table-column type=\"expand\">\n          <template #default=\"props\">\n            <div class=\"assignment-detail\">\n              <div class=\"detail-row\">\n                <div class=\"detail-label\">作业描述：</div>\n                <div class=\"detail-value description\">{{ props.row.description || '无' }}</div>\n              </div>\n              \n              <div class=\"detail-row\" v-if=\"props.row.submissionInfo\">\n                <div class=\"detail-label\">提交状态：</div>\n                <div class=\"detail-value\">\n                  <el-tag :type=\"getSubmissionStatusType(props.row.submissionInfo.status)\">\n                    {{ getSubmissionStatusText(props.row.submissionInfo.status) }}\n                  </el-tag>\n                  \n                  <span v-if=\"props.row.submissionInfo.status > 0\" class=\"submit-time\">\n                    提交时间: {{ props.row.submissionInfo.submitTime }}\n                  </span>\n                  \n                  <el-tag \n                    v-if=\"props.row.submissionInfo.status > 0\" \n                    :type=\"props.row.submissionInfo.isOverdue ? 'danger' : 'success'\" \n                    size=\"small\"\n                    style=\"margin-left: 10px;\"\n                  >\n                    {{ props.row.submissionInfo.isOverdue ? '已逾期' : '按时提交' }}\n                  </el-tag>\n                </div>\n              </div>\n              \n              <div class=\"detail-row\" v-if=\"props.row.submissionInfo && props.row.submissionInfo.status === 2\">\n                <div class=\"detail-label\">得分：</div>\n                <div class=\"detail-value score\">\n                  {{ props.row.submissionInfo.score }} / {{ props.row.maxScore || 100 }}\n                </div>\n              </div>\n              \n              <div class=\"detail-row\" v-if=\"props.row.submissionInfo && props.row.submissionInfo.comment\">\n                <div class=\"detail-label\">教师评语：</div>\n                <div class=\"detail-value comment\">{{ props.row.submissionInfo.comment }}</div>\n              </div>\n              \n              <div class=\"detail-row\" v-if=\"props.row.submissionInfo && props.row.submissionInfo.content\">\n                <div class=\"detail-label\">提交内容：</div>\n                <div class=\"detail-value content\">{{ props.row.submissionInfo.content }}</div>\n              </div>\n              \n              <div class=\"detail-row\" v-if=\"props.row.submissionInfo && props.row.submissionInfo.filePath\">\n                <div class=\"detail-label\">提交文件：</div>\n                <div class=\"detail-value\">\n                  <el-link \n                    :href=\"`/api/assignment/submission/download/${props.row.submissionInfo.id}`\" \n                    target=\"_blank\"\n                    type=\"primary\"\n                  >\n                    {{ props.row.submissionInfo.fileName || '下载文件' }}\n                  </el-link>\n                </div>\n              </div>\n              \n              <div class=\"detail-actions\">\n                <el-button \n                  v-if=\"canSubmit(props.row)\" \n                  type=\"primary\" \n                  @click.stop=\"openSubmitDialog(props.row)\"\n                >\n                  {{ props.row.submissionInfo && props.row.submissionInfo.status > 0 ? '重新提交' : '提交作业' }}\n                </el-button>\n              </div>\n            </div>\n          </template>\n        </el-table-column>\n        \n        <el-table-column prop=\"title\" label=\"作业标题\" min-width=\"200\" show-overflow-tooltip>\n          <template #default=\"scope\">\n            <div class=\"assignment-title\">\n              {{ scope.row.title }}\n              <el-tag \n                v-if=\"isUrgent(scope.row)\" \n                type=\"danger\" \n                size=\"small\" \n                effect=\"dark\"\n                style=\"margin-left: 8px;\"\n              >紧急</el-tag>\n            </div>\n          </template>\n        </el-table-column>\n        \n        <el-table-column prop=\"courseName\" label=\"所属课程\" width=\"180\" show-overflow-tooltip />\n        \n        <el-table-column prop=\"deadline\" label=\"截止时间\" width=\"180\" />\n        \n        <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\n          <template #default=\"scope\">\n            <el-tag :type=\"getStatusType(scope.row.status)\">\n              {{ getStatusText(scope.row.status) }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        \n        <el-table-column label=\"提交状态\" width=\"120\">\n          <template #default=\"scope\">\n            <el-tag \n              v-if=\"scope.row.submissionInfo\" \n              :type=\"getSubmissionStatusType(scope.row.submissionInfo.status)\"\n            >\n              {{ getSubmissionStatusText(scope.row.submissionInfo.status) }}\n            </el-tag>\n            <el-tag v-else type=\"info\">未提交</el-tag>\n          </template>\n        </el-table-column>\n        \n        <el-table-column label=\"得分\" width=\"100\" align=\"center\">\n          <template #default=\"scope\">\n            <span v-if=\"scope.row.submissionInfo && scope.row.submissionInfo.status === 2\">\n              {{ scope.row.submissionInfo.score }}\n            </span>\n            <span v-else>-</span>\n          </template>\n        </el-table-column>\n        \n        <el-table-column prop=\"createTime\" label=\"发布时间\" width=\"180\" />\n        \n        <el-table-column label=\"操作\" width=\"120\" fixed=\"right\">\n          <template #default=\"scope\">\n            <el-button \n              v-if=\"canSubmit(scope.row)\" \n              type=\"primary\" \n              size=\"small\" \n              plain\n              @click.stop=\"openSubmitDialog(scope.row)\"\n            >\n              {{ scope.row.submissionInfo && scope.row.submissionInfo.status > 0 ? '重新提交' : '提交' }}\n            </el-button>\n            <el-button \n              v-else \n              type=\"info\" \n              size=\"small\" \n              plain\n              disabled\n            >{{ getActionText(scope.row) }}</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      \n      <div class=\"pagination-container\">\n        <el-pagination\n          background\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"total\"\n          :page-sizes=\"[10, 20, 50, 100]\"\n          :page-size=\"queryParams.pageSize\"\n          :current-page=\"queryParams.current\"\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n        />\n      </div>\n    </el-card>\n    \n    <!-- 提交作业对话框 -->\n    <el-dialog\n      v-model=\"submitDialogVisible\"\n      title=\"提交作业\"\n      width=\"600px\"\n      :close-on-click-modal=\"false\"\n    >\n      <div v-if=\"currentAssignment\" class=\"submission-form\">\n        <div class=\"assignment-info\">\n          <h3>作业信息</h3>\n          \n          <div class=\"info-row\">\n            <div class=\"info-label\">标题</div>\n            <div class=\"info-value\">{{ currentAssignment.title }}</div>\n          </div>\n          \n          <div class=\"info-row\">\n            <div class=\"info-label\">截止时间</div>\n            <div class=\"info-value\">\n              {{ currentAssignment.deadline }}\n              <el-tag \n                v-if=\"isUrgent(currentAssignment)\" \n                type=\"danger\" \n                size=\"small\" \n                effect=\"dark\"\n                style=\"margin-left: 8px;\"\n              >即将截止</el-tag>\n            </div>\n          </div>\n          \n          <div class=\"info-row\" v-if=\"currentAssignment.description\">\n            <div class=\"info-label\">描述</div>\n            <div class=\"info-value description\">{{ currentAssignment.description }}</div>\n          </div>\n        </div>\n        \n        <div class=\"submission-section\">\n          <h3>提交内容</h3>\n          \n          <el-form :model=\"submissionForm\" ref=\"submissionFormRef\" label-width=\"80px\">\n            <el-form-item label=\"文本内容\">\n              <el-input \n                v-model=\"submissionForm.content\" \n                type=\"textarea\" \n                :rows=\"6\" \n                placeholder=\"请输入作业内容\" \n              />\n            </el-form-item>\n            \n            <el-form-item label=\"上传文件\">\n              <el-upload\n                class=\"upload-area\"\n                :action=\"`/api/assignment/submission/upload`\"\n                :headers=\"uploadHeaders\"\n                :on-success=\"handleUploadSuccess\"\n                :on-error=\"handleUploadError\"\n                :before-upload=\"beforeUpload\"\n                :limit=\"1\"\n                :file-list=\"fileList\"\n                :on-remove=\"handleFileRemove\"\n              >\n                <el-button type=\"primary\">选择文件</el-button>\n                <template #tip>\n                  <div class=\"el-upload__tip\">\n                    支持任意格式文件，单个文件不超过10MB\n                  </div>\n                </template>\n              </el-upload>\n            </el-form-item>\n          </el-form>\n          \n          <div class=\"submission-notice\">\n            <el-alert\n              v-if=\"isDeadlineClose(currentAssignment)\"\n              title=\"警告：此作业即将截止，请尽快提交\"\n              type=\"warning\"\n              :closable=\"false\"\n              show-icon\n            />\n            <el-alert\n              v-if=\"isDeadlinePassed(currentAssignment)\"\n              title=\"注意：此作业已过截止时间，将被标记为逾期提交\"\n              type=\"error\"\n              :closable=\"false\"\n              show-icon\n            />\n          </div>\n        </div>\n      </div>\n      \n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"submitDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"submitAssignment\" :loading=\"submitting\">提交</el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, computed, onMounted } from 'vue'\nimport { ElMessage } from 'element-plus'\nimport axios from 'axios'\n\n// 状态变量\nconst loading = ref(false)\nconst submitting = ref(false)\nconst assignmentList = ref([])\nconst courseList = ref([])\nconst total = ref(0)\nconst submitDialogVisible = ref(false)\nconst currentAssignment = ref(null)\nconst fileList = ref([])\nconst uploadHeaders = ref({})\nconst statistics = ref({})\n\n// 查询参数\nconst queryParams = reactive({\n  current: 1,\n  pageSize: 10,\n  courseId: null,\n  status: null\n})\n\n// 提交表单\nconst submissionFormRef = ref(null)\nconst submissionForm = reactive({\n  assignmentId: null,\n  content: '',\n  filePath: '',\n  fileName: ''\n})\n\n// 计算属性\nconst courseId = computed(() => queryParams.courseId)\n\n// 获取作业状态类型\nconst getStatusType = (status) => {\n  switch (status) {\n    case 0: return 'danger'   // 已关闭\n    case 1: return 'primary'  // 进行中\n    case 2: return 'success'  // 已结束\n    default: return 'info'\n  }\n}\n\n// 获取作业状态文本\nconst getStatusText = (status) => {\n  switch (status) {\n    case 0: return '已关闭'\n    case 1: return '进行中'\n    case 2: return '已结束'\n    default: return '未知'\n  }\n}\n\n// 获取提交状态类型\nconst getSubmissionStatusType = (status) => {\n  switch (status) {\n    case 0: return 'info'    // 未提交\n    case 1: return 'warning' // 已提交\n    case 2: return 'success' // 已批改\n    default: return 'info'\n  }\n}\n\n// 获取提交状态文本\nconst getSubmissionStatusText = (status) => {\n  switch (status) {\n    case 0: return '未提交'\n    case 1: return '已提交'\n    case 2: return '已批改'\n    default: return '未知'\n  }\n}\n\n// 获取操作按钮文本\nconst getActionText = (assignment) => {\n  if (assignment.status === 0) {\n    return '已关闭'\n  } else if (assignment.status === 2) {\n    return '已结束'\n  } else if (assignment.submissionInfo && assignment.submissionInfo.status === 2) {\n    return '已批改'\n  } else {\n    return '提交'\n  }\n}\n\n// 判断是否紧急（距离截止时间不足24小时）\nconst isUrgent = (assignment) => {\n  if (!assignment || !assignment.deadline) return false\n  \n  const now = new Date()\n  const deadline = new Date(assignment.deadline)\n  const diffHours = (deadline - now) / (1000 * 60 * 60)\n  \n  return assignment.status === 1 && diffHours > 0 && diffHours < 24\n}\n\n// 判断是否接近截止（距离截止时间不足24小时）\nconst isDeadlineClose = (assignment) => {\n  return isUrgent(assignment)\n}\n\n// 判断是否已过截止时间\nconst isDeadlinePassed = (assignment) => {\n  if (!assignment || !assignment.deadline) return false\n  \n  const now = new Date()\n  const deadline = new Date(assignment.deadline)\n  \n  return now > deadline\n}\n\n// 判断是否可以提交作业\nconst canSubmit = (assignment) => {\n  // 只有进行中的作业可以提交\n  return assignment.status === 1\n}\n\n// 获取课程列表\nconst fetchCourseList = async () => {\n  try {\n    const userInfo = JSON.parse(localStorage.getItem('userInfo') || '{}')\n    const studentId = userInfo.id\n    \n    if (!studentId) {\n      ElMessage.warning('无法获取用户信息，请重新登录')\n      return\n    }\n    \n    const response = await axios.get(`/api/course/student/${studentId}`)\n    courseList.value = response.data.data || []\n  } catch (error) {\n    console.error('获取课程列表失败:', error)\n    ElMessage.error('获取课程列表失败')\n  }\n}\n\n// 获取作业列表\nconst fetchAssignments = async () => {\n  loading.value = true\n  try {\n    const params = {\n      current: queryParams.current,\n      size: queryParams.pageSize,\n      courseId: queryParams.courseId,\n      status: queryParams.status\n    }\n    \n    const response = await axios.get('/api/assignment/student/list', { params })\n    \n    if (response.data.code === 200) {\n      assignmentList.value = response.data.data.records || []\n      total.value = response.data.data.total || 0\n      \n      // 检查截止日期并标记紧急作业\n      assignmentList.value.forEach(assignment => {\n        assignment.isUrgent = isUrgent(assignment)\n      })\n    } else {\n      ElMessage.error(response.data.message || '获取作业列表失败')\n    }\n  } catch (error) {\n    console.error('获取作业列表失败:', error)\n    ElMessage.error('获取作业列表失败：' + (error.response?.data?.message || error.message))\n  } finally {\n    loading.value = false\n  }\n}\n\n// 获取统计数据\nconst fetchStatistics = async () => {\n  if (!queryParams.courseId) {\n    statistics.value = {}\n    return\n  }\n  \n  try {\n    const response = await axios.get(`/api/assignment/student/completion-rate?courseId=${queryParams.courseId}`)\n    \n    if (response.data.code === 200) {\n      statistics.value = response.data.data || {}\n    }\n  } catch (error) {\n    console.error('获取统计数据失败:', error)\n    ElMessage.error('获取统计数据失败')\n  }\n}\n\n// 重置查询\nconst resetQuery = () => {\n  queryParams.courseId = null\n  queryParams.status = null\n  queryParams.current = 1\n  fetchAssignments()\n  statistics.value = {}\n}\n\n// 处理课程变化\nconst handleCourseChange = () => {\n  queryParams.current = 1\n  fetchAssignments()\n  fetchStatistics()\n}\n\n// 处理页码变化\nconst handleCurrentChange = (current) => {\n  queryParams.current = current\n  fetchAssignments()\n}\n\n// 处理每页条数变化\nconst handleSizeChange = (size) => {\n  queryParams.pageSize = size\n  queryParams.current = 1\n  fetchAssignments()\n}\n\n// 处理点击行\nconst handleRowClick = (row) => {\n  console.log('点击作业:', row)\n}\n\n// 打开提交对话框\nconst openSubmitDialog = (assignment) => {\n  currentAssignment.value = assignment\n  \n  // 初始化表单\n  submissionForm.assignmentId = assignment.id\n  submissionForm.content = assignment.submissionInfo?.content || ''\n  submissionForm.filePath = ''\n  submissionForm.fileName = ''\n  \n  // 初始化文件列表\n  fileList.value = []\n  if (assignment.submissionInfo?.filePath && assignment.submissionInfo?.fileName) {\n    fileList.value = [{\n      name: assignment.submissionInfo.fileName,\n      url: `/api/assignment/submission/download/${assignment.submissionInfo.id}`\n    }]\n  }\n  \n  // 设置上传请求头\n  const token = localStorage.getItem('token')\n  if (token) {\n    uploadHeaders.value = {\n      'Authorization': `Bearer ${token}`\n    }\n  }\n  \n  // 打开对话框\n  submitDialogVisible.value = true\n}\n\n// 文件上传前检查\nconst beforeUpload = (file) => {\n  // 文件大小限制（10MB）\n  const maxSize = 10 * 1024 * 1024\n  if (file.size > maxSize) {\n    ElMessage.error('文件大小不能超过10MB')\n    return false\n  }\n  return true\n}\n\n// 处理上传成功\nconst handleUploadSuccess = (response) => {\n  if (response.code === 200) {\n    ElMessage.success('文件上传成功')\n    submissionForm.filePath = response.data.filePath\n    submissionForm.fileName = response.data.fileName\n  } else {\n    ElMessage.error(response.message || '文件上传失败')\n  }\n}\n\n// 处理上传失败\nconst handleUploadError = (error) => {\n  console.error('文件上传失败:', error)\n  ElMessage.error('文件上传失败')\n}\n\n// 处理文件移除\nconst handleFileRemove = () => {\n  submissionForm.filePath = ''\n  submissionForm.fileName = ''\n}\n\n// 提交作业\nconst submitAssignment = async () => {\n  // 验证文本内容或文件至少提交一项\n  if (!submissionForm.content && !submissionForm.filePath) {\n    ElMessage.warning('请至少提供文本内容或上传文件')\n    return\n  }\n  \n  submitting.value = true\n  try {\n    const formData = new FormData()\n    formData.append('assignmentId', submissionForm.assignmentId)\n    formData.append('content', submissionForm.content || '')\n    \n    if (submissionForm.filePath) {\n      // 如果有文件，使用文件上传接口上传的filePath\n      formData.append('filePath', submissionForm.filePath)\n      formData.append('fileName', submissionForm.fileName)\n    }\n    \n    // 使用AssignmentController已有的API路径\n    const response = await axios.post('/api/assignment/submit', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    })\n    \n    if (response.data.code === 200) {\n      ElMessage.success('作业提交成功')\n      submitDialogVisible.value = false\n      \n      // 重新获取作业列表\n      fetchAssignments()\n      fetchStatistics()\n    } else {\n      ElMessage.error(response.data.message || '作业提交失败')\n    }\n  } catch (error) {\n    console.error('作业提交失败:', error)\n    ElMessage.error('作业提交失败：' + (error.response?.data?.message || error.message))\n  } finally {\n    submitting.value = false\n  }\n}\n\n// 页面加载时获取数据\nonMounted(async () => {\n  await fetchCourseList()\n  await fetchAssignments()\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.assignments-container {\n  padding: 20px;\n  \n  h1 {\n    margin-bottom: 20px;\n    font-size: 24px;\n    font-weight: 500;\n    color: #303133;\n  }\n  \n  .statistics-card {\n    margin-bottom: 20px;\n    \n    .card-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n    }\n    \n    .statistics-row {\n      display: flex;\n      justify-content: space-between;\n      flex-wrap: wrap;\n      gap: 10px;\n      \n      .stat-box {\n        padding: 10px 15px;\n        text-align: center;\n        flex: 1;\n        min-width: 100px;\n        \n        .stat-value {\n          font-size: 22px;\n          font-weight: bold;\n          color: #409EFF;\n          margin-bottom: 5px;\n        }\n        \n        .stat-label {\n          font-size: 14px;\n          color: #909399;\n        }\n      }\n    }\n  }\n  \n  .filter-card {\n    margin-bottom: 20px;\n  }\n  \n  .assignments-card {\n    .assignments-tip {\n      padding: 30px 0;\n    }\n    \n    .assignment-title {\n      display: flex;\n      align-items: center;\n    }\n    \n    .pagination-container {\n      display: flex;\n      justify-content: flex-end;\n      margin-top: 20px;\n    }\n  }\n  \n  .assignment-detail {\n    padding: 20px;\n    \n    .detail-row {\n      display: flex;\n      margin-bottom: 15px;\n      \n      .detail-label {\n        width: 100px;\n        color: #606266;\n        font-weight: 500;\n      }\n      \n      .detail-value {\n        flex: 1;\n        \n        &.description,\n        &.content,\n        &.comment {\n          padding: 10px;\n          background-color: #f9f9f9;\n          border-radius: 4px;\n          min-height: 40px;\n          white-space: pre-line;\n        }\n        \n        &.score {\n          font-weight: bold;\n          color: #E6A23C;\n        }\n        \n        .submit-time {\n          margin-left: 10px;\n          color: #909399;\n          font-size: 14px;\n        }\n      }\n    }\n    \n    .detail-actions {\n      display: flex;\n      justify-content: flex-end;\n      margin-top: 20px;\n    }\n  }\n  \n  .submission-form {\n    .assignment-info {\n      margin-bottom: 20px;\n      \n      h3 {\n        font-size: 16px;\n        font-weight: 500;\n        margin-bottom: 15px;\n        color: #303133;\n        border-bottom: 1px solid #EBEEF5;\n        padding-bottom: 10px;\n      }\n      \n      .info-row {\n        display: flex;\n        margin-bottom: 15px;\n        \n        .info-label {\n          width: 80px;\n          color: #606266;\n          font-weight: 500;\n        }\n        \n        .info-value {\n          flex: 1;\n          \n          &.description {\n            padding: 10px;\n            background-color: #f9f9f9;\n            border-radius: 4px;\n            max-height: 100px;\n            overflow-y: auto;\n            white-space: pre-line;\n          }\n        }\n      }\n    }\n    \n    .submission-section {\n      h3 {\n        font-size: 16px;\n        font-weight: 500;\n        margin-bottom: 15px;\n        color: #303133;\n        border-bottom: 1px solid #EBEEF5;\n        padding-bottom: 10px;\n      }\n      \n      .upload-area {\n        width: 100%;\n        border: 1px dashed #d9d9d9;\n        border-radius: 6px;\n        padding: 20px;\n        text-align: center;\n        \n        &:hover {\n          border-color: #409EFF;\n        }\n      }\n      \n      .submission-notice {\n        margin-top: 20px;\n      }\n    }\n  }\n}\n</style> ","import script from \"./Assignments.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Assignments.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Assignments.vue?vue&type=style&index=0&id=11312528&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-11312528\"]])\n\nexport default __exports__"],"names":["loading","ref","submitting","assignmentList","courseList","total","submitDialogVisible","currentAssignment","fileList","uploadHeaders","statistics","queryParams","reactive","current","pageSize","courseId","status","submissionFormRef","submissionForm","assignmentId","content","filePath","fileName","computed","getStatusType","getStatusText","getSubmissionStatusType","getSubmissionStatusText","getActionText","assignment","submissionInfo","isUrgent","deadline","now","Date","diffHours","isDeadlineClose","isDeadlinePassed","canSubmit","fetchCourseList","async","userInfo","JSON","parse","localStorage","getItem","studentId","id","ElMessage","warning","response","axios","value","data","error","console","fetchAssignments","params","size","code","records","forEach","message","fetchStatistics","resetQuery","handleCourseChange","handleCurrentChange","handleSizeChange","handleRowClick","row","log","openSubmitDialog","name","url","token","beforeUpload","file","maxSize","handleUploadSuccess","success","handleUploadError","handleFileRemove","submitAssignment","formData","FormData","append","headers","onMounted","__exports__"],"sourceRoot":""}