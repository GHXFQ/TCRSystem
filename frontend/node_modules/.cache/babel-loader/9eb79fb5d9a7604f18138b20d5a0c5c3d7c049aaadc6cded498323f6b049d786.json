{"ast":null,"code":"import { ref, reactive, computed, onMounted } from 'vue';\nimport { ElMessage } from 'element-plus';\nimport axios from 'axios';\n\n// 状态变量\n\nexport default {\n  __name: 'Assignments',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const loading = ref(false);\n    const submitting = ref(false);\n    const assignmentList = ref([]);\n    const courseList = ref([]);\n    const total = ref(0);\n    const submitDialogVisible = ref(false);\n    const currentAssignment = ref(null);\n    const fileList = ref([]);\n    const uploadHeaders = ref({});\n    const statistics = ref({});\n\n    // 查询参数\n    const queryParams = reactive({\n      current: 1,\n      pageSize: 10,\n      courseId: null,\n      status: null\n    });\n\n    // 提交表单\n    const submissionFormRef = ref(null);\n    const submissionForm = reactive({\n      assignmentId: null,\n      content: '',\n      filePath: '',\n      fileName: ''\n    });\n\n    // 计算属性\n    const courseId = computed(() => queryParams.courseId);\n\n    // 获取作业状态类型\n    const getStatusType = status => {\n      switch (status) {\n        case 0:\n          return 'danger';\n        // 已关闭\n        case 1:\n          return 'primary';\n        // 进行中\n        case 2:\n          return 'success';\n        // 已结束\n        default:\n          return 'info';\n      }\n    };\n\n    // 获取作业状态文本\n    const getStatusText = status => {\n      switch (status) {\n        case 0:\n          return '已关闭';\n        case 1:\n          return '进行中';\n        case 2:\n          return '已结束';\n        default:\n          return '未知';\n      }\n    };\n\n    // 获取提交状态类型\n    const getSubmissionStatusType = status => {\n      switch (status) {\n        case 0:\n          return 'info';\n        // 未提交\n        case 1:\n          return 'warning';\n        // 已提交\n        case 2:\n          return 'success';\n        // 已批改\n        default:\n          return 'info';\n      }\n    };\n\n    // 获取提交状态文本\n    const getSubmissionStatusText = status => {\n      switch (status) {\n        case 0:\n          return '未提交';\n        case 1:\n          return '已提交';\n        case 2:\n          return '已批改';\n        default:\n          return '未知';\n      }\n    };\n\n    // 获取操作按钮文本\n    const getActionText = assignment => {\n      if (assignment.status === 0) {\n        return '已关闭';\n      } else if (assignment.status === 2) {\n        return '已结束';\n      } else if (assignment.submissionInfo && assignment.submissionInfo.status === 2) {\n        return '已批改';\n      } else {\n        return '提交';\n      }\n    };\n\n    // 判断是否紧急（距离截止时间不足24小时）\n    const isUrgent = assignment => {\n      if (!assignment || !assignment.deadline) return false;\n      const now = new Date();\n      const deadline = new Date(assignment.deadline);\n      const diffHours = (deadline - now) / (1000 * 60 * 60);\n      return assignment.status === 1 && diffHours > 0 && diffHours < 24;\n    };\n\n    // 判断是否接近截止（距离截止时间不足24小时）\n    const isDeadlineClose = assignment => {\n      return isUrgent(assignment);\n    };\n\n    // 判断是否已过截止时间\n    const isDeadlinePassed = assignment => {\n      if (!assignment || !assignment.deadline) return false;\n      const now = new Date();\n      const deadline = new Date(assignment.deadline);\n      return now > deadline;\n    };\n\n    // 判断是否可以提交作业\n    const canSubmit = assignment => {\n      // 只有进行中的作业可以提交\n      return assignment.status === 1;\n    };\n\n    // 获取课程列表\n    const fetchCourseList = async () => {\n      try {\n        const userInfo = JSON.parse(localStorage.getItem('userInfo') || '{}');\n        const studentId = userInfo.id;\n        if (!studentId) {\n          ElMessage.warning('无法获取用户信息，请重新登录');\n          return;\n        }\n        const response = await axios.get(`/api/course/student/${studentId}`);\n        courseList.value = response.data.data || [];\n      } catch (error) {\n        console.error('获取课程列表失败:', error);\n        ElMessage.error('获取课程列表失败');\n      }\n    };\n\n    // 获取作业列表\n    const fetchAssignments = async () => {\n      loading.value = true;\n      try {\n        const params = {\n          current: queryParams.current,\n          size: queryParams.pageSize,\n          courseId: queryParams.courseId,\n          status: queryParams.status\n        };\n        const response = await axios.get('/api/assignment/student/list', {\n          params\n        });\n        if (response.data.code === 200) {\n          assignmentList.value = response.data.data.records || [];\n          total.value = response.data.data.total || 0;\n\n          // 检查截止日期并标记紧急作业\n          assignmentList.value.forEach(assignment => {\n            assignment.isUrgent = isUrgent(assignment);\n          });\n        } else {\n          ElMessage.error(response.data.message || '获取作业列表失败');\n        }\n      } catch (error) {\n        console.error('获取作业列表失败:', error);\n        ElMessage.error('获取作业列表失败：' + (error.response?.data?.message || error.message));\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // 获取统计数据\n    const fetchStatistics = async () => {\n      if (!queryParams.courseId) {\n        statistics.value = {};\n        return;\n      }\n      try {\n        const response = await axios.get(`/api/assignment/student/completion-rate?courseId=${queryParams.courseId}`);\n        if (response.data.code === 200) {\n          statistics.value = response.data.data || {};\n        }\n      } catch (error) {\n        console.error('获取统计数据失败:', error);\n        ElMessage.error('获取统计数据失败');\n      }\n    };\n\n    // 重置查询\n    const resetQuery = () => {\n      queryParams.courseId = null;\n      queryParams.status = null;\n      queryParams.current = 1;\n      fetchAssignments();\n      statistics.value = {};\n    };\n\n    // 处理课程变化\n    const handleCourseChange = () => {\n      queryParams.current = 1;\n      fetchAssignments();\n      fetchStatistics();\n    };\n\n    // 处理页码变化\n    const handleCurrentChange = current => {\n      queryParams.current = current;\n      fetchAssignments();\n    };\n\n    // 处理每页条数变化\n    const handleSizeChange = size => {\n      queryParams.pageSize = size;\n      queryParams.current = 1;\n      fetchAssignments();\n    };\n\n    // 处理点击行\n    const handleRowClick = row => {\n      console.log('点击作业:', row);\n    };\n\n    // 打开提交对话框\n    const openSubmitDialog = assignment => {\n      currentAssignment.value = assignment;\n\n      // 初始化表单\n      submissionForm.assignmentId = assignment.id;\n      submissionForm.content = assignment.submissionInfo?.content || '';\n      submissionForm.filePath = '';\n      submissionForm.fileName = '';\n\n      // 初始化文件列表\n      fileList.value = [];\n      if (assignment.submissionInfo?.filePath && assignment.submissionInfo?.fileName) {\n        fileList.value = [{\n          name: assignment.submissionInfo.fileName,\n          url: `/api/assignment/submission/download/${assignment.submissionInfo.id}`\n        }];\n      }\n\n      // 设置上传请求头\n      const token = localStorage.getItem('token');\n      if (token) {\n        uploadHeaders.value = {\n          'Authorization': `Bearer ${token}`\n        };\n      }\n\n      // 打开对话框\n      submitDialogVisible.value = true;\n    };\n\n    // 文件上传前检查\n    const beforeUpload = file => {\n      // 文件大小限制（10MB）\n      const maxSize = 10 * 1024 * 1024;\n      if (file.size > maxSize) {\n        ElMessage.error('文件大小不能超过10MB');\n        return false;\n      }\n      return true;\n    };\n\n    // 处理上传成功\n    const handleUploadSuccess = response => {\n      if (response.code === 200) {\n        ElMessage.success('文件上传成功');\n        submissionForm.filePath = response.data.filePath;\n        submissionForm.fileName = response.data.fileName;\n      } else {\n        ElMessage.error(response.message || '文件上传失败');\n      }\n    };\n\n    // 处理上传失败\n    const handleUploadError = error => {\n      console.error('文件上传失败:', error);\n      ElMessage.error('文件上传失败');\n    };\n\n    // 处理文件移除\n    const handleFileRemove = () => {\n      submissionForm.filePath = '';\n      submissionForm.fileName = '';\n    };\n\n    // 提交作业\n    const submitAssignment = async () => {\n      // 验证文本内容或文件至少提交一项\n      if (!submissionForm.content && !submissionForm.filePath) {\n        ElMessage.warning('请至少提供文本内容或上传文件');\n        return;\n      }\n      submitting.value = true;\n      try {\n        const formData = new FormData();\n        formData.append('assignmentId', submissionForm.assignmentId);\n        formData.append('content', submissionForm.content || '');\n        if (submissionForm.filePath) {\n          // 如果有文件，使用文件上传接口上传的filePath\n          formData.append('filePath', submissionForm.filePath);\n          formData.append('fileName', submissionForm.fileName);\n        }\n\n        // 使用AssignmentController已有的API路径\n        const response = await axios.post('/api/assignment/submit', formData, {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        if (response.data.code === 200) {\n          ElMessage.success('作业提交成功');\n          submitDialogVisible.value = false;\n\n          // 重新获取作业列表\n          fetchAssignments();\n          fetchStatistics();\n        } else {\n          ElMessage.error(response.data.message || '作业提交失败');\n        }\n      } catch (error) {\n        console.error('作业提交失败:', error);\n        ElMessage.error('作业提交失败：' + (error.response?.data?.message || error.message));\n      } finally {\n        submitting.value = false;\n      }\n    };\n\n    // 页面加载时获取数据\n    onMounted(async () => {\n      await fetchCourseList();\n      await fetchAssignments();\n    });\n    const __returned__ = {\n      loading,\n      submitting,\n      assignmentList,\n      courseList,\n      total,\n      submitDialogVisible,\n      currentAssignment,\n      fileList,\n      uploadHeaders,\n      statistics,\n      queryParams,\n      submissionFormRef,\n      submissionForm,\n      courseId,\n      getStatusType,\n      getStatusText,\n      getSubmissionStatusType,\n      getSubmissionStatusText,\n      getActionText,\n      isUrgent,\n      isDeadlineClose,\n      isDeadlinePassed,\n      canSubmit,\n      fetchCourseList,\n      fetchAssignments,\n      fetchStatistics,\n      resetQuery,\n      handleCourseChange,\n      handleCurrentChange,\n      handleSizeChange,\n      handleRowClick,\n      openSubmitDialog,\n      beforeUpload,\n      handleUploadSuccess,\n      handleUploadError,\n      handleFileRemove,\n      submitAssignment,\n      ref,\n      reactive,\n      computed,\n      onMounted,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","reactive","computed","onMounted","ElMessage","axios","loading","submitting","assignmentList","courseList","total","submitDialogVisible","currentAssignment","fileList","uploadHeaders","statistics","queryParams","current","pageSize","courseId","status","submissionFormRef","submissionForm","assignmentId","content","filePath","fileName","getStatusType","getStatusText","getSubmissionStatusType","getSubmissionStatusText","getActionText","assignment","submissionInfo","isUrgent","deadline","now","Date","diffHours","isDeadlineClose","isDeadlinePassed","canSubmit","fetchCourseList","userInfo","JSON","parse","localStorage","getItem","studentId","id","warning","response","get","value","data","error","console","fetchAssignments","params","size","code","records","forEach","message","fetchStatistics","resetQuery","handleCourseChange","handleCurrentChange","handleSizeChange","handleRowClick","row","log","openSubmitDialog","name","url","token","beforeUpload","file","maxSize","handleUploadSuccess","success","handleUploadError","handleFileRemove","submitAssignment","formData","FormData","append","post","headers"],"sources":["C:/Users/18083/Desktop/CCIT/TCRSystem/TCRSystem/frontend/src/views/student/Assignments.vue"],"sourcesContent":["<template>\n  <div class=\"assignments-container\">\n    <h1>课程作业</h1>\n    \n    <!-- 作业统计卡片 -->\n    <el-card class=\"statistics-card\" v-if=\"courseId\">\n      <template #header>\n        <div class=\"card-header\">\n          <span>课程完成情况</span>\n          <el-tag type=\"success\" v-if=\"statistics.completionRate\">完成率: {{ statistics.completionRate }}</el-tag>\n        </div>\n      </template>\n      \n      <div class=\"statistics-row\">\n        <div class=\"stat-box\">\n          <div class=\"stat-value\">{{ statistics.totalAssignments || 0 }}</div>\n          <div class=\"stat-label\">总作业数</div>\n        </div>\n        <div class=\"stat-box\">\n          <div class=\"stat-value\">{{ statistics.submittedCount || 0 }}</div>\n          <div class=\"stat-label\">已提交数</div>\n        </div>\n        <div class=\"stat-box\">\n          <div class=\"stat-value\">{{ statistics.gradedCount || 0 }}</div>\n          <div class=\"stat-label\">已批改数</div>\n        </div>\n        <div class=\"stat-box\">\n          <div class=\"stat-value\">{{ statistics.averageScore || '暂无' }}</div>\n          <div class=\"stat-label\">平均分</div>\n        </div>\n      </div>\n    </el-card>\n    \n    <!-- 查询过滤卡片 -->\n    <el-card class=\"filter-card\">\n      <el-form :inline=\"true\" :model=\"queryParams\" class=\"filter-form\">\n        <el-form-item label=\"课程\">\n          <el-select \n            v-model=\"queryParams.courseId\" \n            placeholder=\"选择课程\" \n            clearable \n            filterable\n            style=\"width: 220px;\"\n            @change=\"handleCourseChange\"\n          >\n            <el-option\n              v-for=\"course in courseList\"\n              :key=\"course.id\"\n              :label=\"course.name\"\n              :value=\"course.id\"\n            />\n          </el-select>\n        </el-form-item>\n        \n        <el-form-item label=\"状态\">\n          <el-select \n            v-model=\"queryParams.status\" \n            placeholder=\"选择状态\" \n            clearable \n            style=\"width: 120px;\"\n          >\n            <el-option label=\"进行中\" :value=\"1\"></el-option>\n            <el-option label=\"已结束\" :value=\"2\"></el-option>\n            <el-option label=\"已关闭\" :value=\"0\"></el-option>\n          </el-select>\n        </el-form-item>\n        \n        <el-form-item>\n          <el-button type=\"primary\" @click=\"fetchAssignments\">查询</el-button>\n          <el-button @click=\"resetQuery\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n    \n    <!-- 作业列表 -->\n    <el-card v-loading=\"loading\" class=\"assignments-card\">\n      <div class=\"assignments-tip\" v-if=\"!assignmentList.length && !loading\">\n        <el-empty description=\"暂无符合条件的作业\"></el-empty>\n      </div>\n      \n      <el-table \n        v-else \n        :data=\"assignmentList\" \n        style=\"width: 100%\"\n        border\n        @row-click=\"handleRowClick\"\n      >\n        <el-table-column type=\"expand\">\n          <template #default=\"props\">\n            <div class=\"assignment-detail\">\n              <div class=\"detail-row\">\n                <div class=\"detail-label\">作业描述：</div>\n                <div class=\"detail-value description\">{{ props.row.description || '无' }}</div>\n              </div>\n              \n              <div class=\"detail-row\" v-if=\"props.row.submissionInfo\">\n                <div class=\"detail-label\">提交状态：</div>\n                <div class=\"detail-value\">\n                  <el-tag :type=\"getSubmissionStatusType(props.row.submissionInfo.status)\">\n                    {{ getSubmissionStatusText(props.row.submissionInfo.status) }}\n                  </el-tag>\n                  \n                  <span v-if=\"props.row.submissionInfo.status > 0\" class=\"submit-time\">\n                    提交时间: {{ props.row.submissionInfo.submitTime }}\n                  </span>\n                  \n                  <el-tag \n                    v-if=\"props.row.submissionInfo.status > 0\" \n                    :type=\"props.row.submissionInfo.isOverdue ? 'danger' : 'success'\" \n                    size=\"small\"\n                    style=\"margin-left: 10px;\"\n                  >\n                    {{ props.row.submissionInfo.isOverdue ? '已逾期' : '按时提交' }}\n                  </el-tag>\n                </div>\n              </div>\n              \n              <div class=\"detail-row\" v-if=\"props.row.submissionInfo && props.row.submissionInfo.status === 2\">\n                <div class=\"detail-label\">得分：</div>\n                <div class=\"detail-value score\">\n                  {{ props.row.submissionInfo.score }} / {{ props.row.maxScore || 100 }}\n                </div>\n              </div>\n              \n              <div class=\"detail-row\" v-if=\"props.row.submissionInfo && props.row.submissionInfo.comment\">\n                <div class=\"detail-label\">教师评语：</div>\n                <div class=\"detail-value comment\">{{ props.row.submissionInfo.comment }}</div>\n              </div>\n              \n              <div class=\"detail-row\" v-if=\"props.row.submissionInfo && props.row.submissionInfo.content\">\n                <div class=\"detail-label\">提交内容：</div>\n                <div class=\"detail-value content\">{{ props.row.submissionInfo.content }}</div>\n              </div>\n              \n              <div class=\"detail-row\" v-if=\"props.row.submissionInfo && props.row.submissionInfo.filePath\">\n                <div class=\"detail-label\">提交文件：</div>\n                <div class=\"detail-value\">\n                  <el-link \n                    :href=\"`/api/assignment/submission/download/${props.row.submissionInfo.id}`\" \n                    target=\"_blank\"\n                    type=\"primary\"\n                  >\n                    {{ props.row.submissionInfo.fileName || '下载文件' }}\n                  </el-link>\n                </div>\n              </div>\n              \n              <div class=\"detail-actions\">\n                <el-button \n                  v-if=\"canSubmit(props.row)\" \n                  type=\"primary\" \n                  @click.stop=\"openSubmitDialog(props.row)\"\n                >\n                  {{ props.row.submissionInfo && props.row.submissionInfo.status > 0 ? '重新提交' : '提交作业' }}\n                </el-button>\n              </div>\n            </div>\n          </template>\n        </el-table-column>\n        \n        <el-table-column prop=\"title\" label=\"作业标题\" min-width=\"200\" show-overflow-tooltip>\n          <template #default=\"scope\">\n            <div class=\"assignment-title\">\n              {{ scope.row.title }}\n              <el-tag \n                v-if=\"isUrgent(scope.row)\" \n                type=\"danger\" \n                size=\"small\" \n                effect=\"dark\"\n                style=\"margin-left: 8px;\"\n              >紧急</el-tag>\n            </div>\n          </template>\n        </el-table-column>\n        \n        <el-table-column prop=\"courseName\" label=\"所属课程\" width=\"180\" show-overflow-tooltip />\n        \n        <el-table-column prop=\"deadline\" label=\"截止时间\" width=\"180\" />\n        \n        <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\n          <template #default=\"scope\">\n            <el-tag :type=\"getStatusType(scope.row.status)\">\n              {{ getStatusText(scope.row.status) }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        \n        <el-table-column label=\"提交状态\" width=\"120\">\n          <template #default=\"scope\">\n            <el-tag \n              v-if=\"scope.row.submissionInfo\" \n              :type=\"getSubmissionStatusType(scope.row.submissionInfo.status)\"\n            >\n              {{ getSubmissionStatusText(scope.row.submissionInfo.status) }}\n            </el-tag>\n            <el-tag v-else type=\"info\">未提交</el-tag>\n          </template>\n        </el-table-column>\n        \n        <el-table-column label=\"得分\" width=\"100\" align=\"center\">\n          <template #default=\"scope\">\n            <span v-if=\"scope.row.submissionInfo && scope.row.submissionInfo.status === 2\">\n              {{ scope.row.submissionInfo.score }}\n            </span>\n            <span v-else>-</span>\n          </template>\n        </el-table-column>\n        \n        <el-table-column prop=\"createTime\" label=\"发布时间\" width=\"180\" />\n        \n        <el-table-column label=\"操作\" width=\"120\" fixed=\"right\">\n          <template #default=\"scope\">\n            <el-button \n              v-if=\"canSubmit(scope.row)\" \n              type=\"primary\" \n              size=\"small\" \n              plain\n              @click.stop=\"openSubmitDialog(scope.row)\"\n            >\n              {{ scope.row.submissionInfo && scope.row.submissionInfo.status > 0 ? '重新提交' : '提交' }}\n            </el-button>\n            <el-button \n              v-else \n              type=\"info\" \n              size=\"small\" \n              plain\n              disabled\n            >{{ getActionText(scope.row) }}</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      \n      <div class=\"pagination-container\">\n        <el-pagination\n          background\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"total\"\n          :page-sizes=\"[10, 20, 50, 100]\"\n          :page-size=\"queryParams.pageSize\"\n          :current-page=\"queryParams.current\"\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n        />\n      </div>\n    </el-card>\n    \n    <!-- 提交作业对话框 -->\n    <el-dialog\n      v-model=\"submitDialogVisible\"\n      title=\"提交作业\"\n      width=\"600px\"\n      :close-on-click-modal=\"false\"\n    >\n      <div v-if=\"currentAssignment\" class=\"submission-form\">\n        <div class=\"assignment-info\">\n          <h3>作业信息</h3>\n          \n          <div class=\"info-row\">\n            <div class=\"info-label\">标题</div>\n            <div class=\"info-value\">{{ currentAssignment.title }}</div>\n          </div>\n          \n          <div class=\"info-row\">\n            <div class=\"info-label\">截止时间</div>\n            <div class=\"info-value\">\n              {{ currentAssignment.deadline }}\n              <el-tag \n                v-if=\"isUrgent(currentAssignment)\" \n                type=\"danger\" \n                size=\"small\" \n                effect=\"dark\"\n                style=\"margin-left: 8px;\"\n              >即将截止</el-tag>\n            </div>\n          </div>\n          \n          <div class=\"info-row\" v-if=\"currentAssignment.description\">\n            <div class=\"info-label\">描述</div>\n            <div class=\"info-value description\">{{ currentAssignment.description }}</div>\n          </div>\n        </div>\n        \n        <div class=\"submission-section\">\n          <h3>提交内容</h3>\n          \n          <el-form :model=\"submissionForm\" ref=\"submissionFormRef\" label-width=\"80px\">\n            <el-form-item label=\"文本内容\">\n              <el-input \n                v-model=\"submissionForm.content\" \n                type=\"textarea\" \n                :rows=\"6\" \n                placeholder=\"请输入作业内容\" \n              />\n            </el-form-item>\n            \n            <el-form-item label=\"上传文件\">\n              <el-upload\n                class=\"upload-area\"\n                :action=\"`/api/assignment/submission/upload`\"\n                :headers=\"uploadHeaders\"\n                :on-success=\"handleUploadSuccess\"\n                :on-error=\"handleUploadError\"\n                :before-upload=\"beforeUpload\"\n                :limit=\"1\"\n                :file-list=\"fileList\"\n                :on-remove=\"handleFileRemove\"\n              >\n                <el-button type=\"primary\">选择文件</el-button>\n                <template #tip>\n                  <div class=\"el-upload__tip\">\n                    支持任意格式文件，单个文件不超过10MB\n                  </div>\n                </template>\n              </el-upload>\n            </el-form-item>\n          </el-form>\n          \n          <div class=\"submission-notice\">\n            <el-alert\n              v-if=\"isDeadlineClose(currentAssignment)\"\n              title=\"警告：此作业即将截止，请尽快提交\"\n              type=\"warning\"\n              :closable=\"false\"\n              show-icon\n            />\n            <el-alert\n              v-if=\"isDeadlinePassed(currentAssignment)\"\n              title=\"注意：此作业已过截止时间，将被标记为逾期提交\"\n              type=\"error\"\n              :closable=\"false\"\n              show-icon\n            />\n          </div>\n        </div>\n      </div>\n      \n      <template #footer>\n        <span class=\"dialog-footer\">\n          <el-button @click=\"submitDialogVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"submitAssignment\" :loading=\"submitting\">提交</el-button>\n        </span>\n      </template>\n    </el-dialog>\n  </div>\n</template>\n\n<script setup>\nimport { ref, reactive, computed, onMounted } from 'vue'\nimport { ElMessage } from 'element-plus'\nimport axios from 'axios'\n\n// 状态变量\nconst loading = ref(false)\nconst submitting = ref(false)\nconst assignmentList = ref([])\nconst courseList = ref([])\nconst total = ref(0)\nconst submitDialogVisible = ref(false)\nconst currentAssignment = ref(null)\nconst fileList = ref([])\nconst uploadHeaders = ref({})\nconst statistics = ref({})\n\n// 查询参数\nconst queryParams = reactive({\n  current: 1,\n  pageSize: 10,\n  courseId: null,\n  status: null\n})\n\n// 提交表单\nconst submissionFormRef = ref(null)\nconst submissionForm = reactive({\n  assignmentId: null,\n  content: '',\n  filePath: '',\n  fileName: ''\n})\n\n// 计算属性\nconst courseId = computed(() => queryParams.courseId)\n\n// 获取作业状态类型\nconst getStatusType = (status) => {\n  switch (status) {\n    case 0: return 'danger'   // 已关闭\n    case 1: return 'primary'  // 进行中\n    case 2: return 'success'  // 已结束\n    default: return 'info'\n  }\n}\n\n// 获取作业状态文本\nconst getStatusText = (status) => {\n  switch (status) {\n    case 0: return '已关闭'\n    case 1: return '进行中'\n    case 2: return '已结束'\n    default: return '未知'\n  }\n}\n\n// 获取提交状态类型\nconst getSubmissionStatusType = (status) => {\n  switch (status) {\n    case 0: return 'info'    // 未提交\n    case 1: return 'warning' // 已提交\n    case 2: return 'success' // 已批改\n    default: return 'info'\n  }\n}\n\n// 获取提交状态文本\nconst getSubmissionStatusText = (status) => {\n  switch (status) {\n    case 0: return '未提交'\n    case 1: return '已提交'\n    case 2: return '已批改'\n    default: return '未知'\n  }\n}\n\n// 获取操作按钮文本\nconst getActionText = (assignment) => {\n  if (assignment.status === 0) {\n    return '已关闭'\n  } else if (assignment.status === 2) {\n    return '已结束'\n  } else if (assignment.submissionInfo && assignment.submissionInfo.status === 2) {\n    return '已批改'\n  } else {\n    return '提交'\n  }\n}\n\n// 判断是否紧急（距离截止时间不足24小时）\nconst isUrgent = (assignment) => {\n  if (!assignment || !assignment.deadline) return false\n  \n  const now = new Date()\n  const deadline = new Date(assignment.deadline)\n  const diffHours = (deadline - now) / (1000 * 60 * 60)\n  \n  return assignment.status === 1 && diffHours > 0 && diffHours < 24\n}\n\n// 判断是否接近截止（距离截止时间不足24小时）\nconst isDeadlineClose = (assignment) => {\n  return isUrgent(assignment)\n}\n\n// 判断是否已过截止时间\nconst isDeadlinePassed = (assignment) => {\n  if (!assignment || !assignment.deadline) return false\n  \n  const now = new Date()\n  const deadline = new Date(assignment.deadline)\n  \n  return now > deadline\n}\n\n// 判断是否可以提交作业\nconst canSubmit = (assignment) => {\n  // 只有进行中的作业可以提交\n  return assignment.status === 1\n}\n\n// 获取课程列表\nconst fetchCourseList = async () => {\n  try {\n    const userInfo = JSON.parse(localStorage.getItem('userInfo') || '{}')\n    const studentId = userInfo.id\n    \n    if (!studentId) {\n      ElMessage.warning('无法获取用户信息，请重新登录')\n      return\n    }\n    \n    const response = await axios.get(`/api/course/student/${studentId}`)\n    courseList.value = response.data.data || []\n  } catch (error) {\n    console.error('获取课程列表失败:', error)\n    ElMessage.error('获取课程列表失败')\n  }\n}\n\n// 获取作业列表\nconst fetchAssignments = async () => {\n  loading.value = true\n  try {\n    const params = {\n      current: queryParams.current,\n      size: queryParams.pageSize,\n      courseId: queryParams.courseId,\n      status: queryParams.status\n    }\n    \n    const response = await axios.get('/api/assignment/student/list', { params })\n    \n    if (response.data.code === 200) {\n      assignmentList.value = response.data.data.records || []\n      total.value = response.data.data.total || 0\n      \n      // 检查截止日期并标记紧急作业\n      assignmentList.value.forEach(assignment => {\n        assignment.isUrgent = isUrgent(assignment)\n      })\n    } else {\n      ElMessage.error(response.data.message || '获取作业列表失败')\n    }\n  } catch (error) {\n    console.error('获取作业列表失败:', error)\n    ElMessage.error('获取作业列表失败：' + (error.response?.data?.message || error.message))\n  } finally {\n    loading.value = false\n  }\n}\n\n// 获取统计数据\nconst fetchStatistics = async () => {\n  if (!queryParams.courseId) {\n    statistics.value = {}\n    return\n  }\n  \n  try {\n    const response = await axios.get(`/api/assignment/student/completion-rate?courseId=${queryParams.courseId}`)\n    \n    if (response.data.code === 200) {\n      statistics.value = response.data.data || {}\n    }\n  } catch (error) {\n    console.error('获取统计数据失败:', error)\n    ElMessage.error('获取统计数据失败')\n  }\n}\n\n// 重置查询\nconst resetQuery = () => {\n  queryParams.courseId = null\n  queryParams.status = null\n  queryParams.current = 1\n  fetchAssignments()\n  statistics.value = {}\n}\n\n// 处理课程变化\nconst handleCourseChange = () => {\n  queryParams.current = 1\n  fetchAssignments()\n  fetchStatistics()\n}\n\n// 处理页码变化\nconst handleCurrentChange = (current) => {\n  queryParams.current = current\n  fetchAssignments()\n}\n\n// 处理每页条数变化\nconst handleSizeChange = (size) => {\n  queryParams.pageSize = size\n  queryParams.current = 1\n  fetchAssignments()\n}\n\n// 处理点击行\nconst handleRowClick = (row) => {\n  console.log('点击作业:', row)\n}\n\n// 打开提交对话框\nconst openSubmitDialog = (assignment) => {\n  currentAssignment.value = assignment\n  \n  // 初始化表单\n  submissionForm.assignmentId = assignment.id\n  submissionForm.content = assignment.submissionInfo?.content || ''\n  submissionForm.filePath = ''\n  submissionForm.fileName = ''\n  \n  // 初始化文件列表\n  fileList.value = []\n  if (assignment.submissionInfo?.filePath && assignment.submissionInfo?.fileName) {\n    fileList.value = [{\n      name: assignment.submissionInfo.fileName,\n      url: `/api/assignment/submission/download/${assignment.submissionInfo.id}`\n    }]\n  }\n  \n  // 设置上传请求头\n  const token = localStorage.getItem('token')\n  if (token) {\n    uploadHeaders.value = {\n      'Authorization': `Bearer ${token}`\n    }\n  }\n  \n  // 打开对话框\n  submitDialogVisible.value = true\n}\n\n// 文件上传前检查\nconst beforeUpload = (file) => {\n  // 文件大小限制（10MB）\n  const maxSize = 10 * 1024 * 1024\n  if (file.size > maxSize) {\n    ElMessage.error('文件大小不能超过10MB')\n    return false\n  }\n  return true\n}\n\n// 处理上传成功\nconst handleUploadSuccess = (response) => {\n  if (response.code === 200) {\n    ElMessage.success('文件上传成功')\n    submissionForm.filePath = response.data.filePath\n    submissionForm.fileName = response.data.fileName\n  } else {\n    ElMessage.error(response.message || '文件上传失败')\n  }\n}\n\n// 处理上传失败\nconst handleUploadError = (error) => {\n  console.error('文件上传失败:', error)\n  ElMessage.error('文件上传失败')\n}\n\n// 处理文件移除\nconst handleFileRemove = () => {\n  submissionForm.filePath = ''\n  submissionForm.fileName = ''\n}\n\n// 提交作业\nconst submitAssignment = async () => {\n  // 验证文本内容或文件至少提交一项\n  if (!submissionForm.content && !submissionForm.filePath) {\n    ElMessage.warning('请至少提供文本内容或上传文件')\n    return\n  }\n  \n  submitting.value = true\n  try {\n    const formData = new FormData()\n    formData.append('assignmentId', submissionForm.assignmentId)\n    formData.append('content', submissionForm.content || '')\n    \n    if (submissionForm.filePath) {\n      // 如果有文件，使用文件上传接口上传的filePath\n      formData.append('filePath', submissionForm.filePath)\n      formData.append('fileName', submissionForm.fileName)\n    }\n    \n    // 使用AssignmentController已有的API路径\n    const response = await axios.post('/api/assignment/submit', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    })\n    \n    if (response.data.code === 200) {\n      ElMessage.success('作业提交成功')\n      submitDialogVisible.value = false\n      \n      // 重新获取作业列表\n      fetchAssignments()\n      fetchStatistics()\n    } else {\n      ElMessage.error(response.data.message || '作业提交失败')\n    }\n  } catch (error) {\n    console.error('作业提交失败:', error)\n    ElMessage.error('作业提交失败：' + (error.response?.data?.message || error.message))\n  } finally {\n    submitting.value = false\n  }\n}\n\n// 页面加载时获取数据\nonMounted(async () => {\n  await fetchCourseList()\n  await fetchAssignments()\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.assignments-container {\n  padding: 20px;\n  \n  h1 {\n    margin-bottom: 20px;\n    font-size: 24px;\n    font-weight: 500;\n    color: #303133;\n  }\n  \n  .statistics-card {\n    margin-bottom: 20px;\n    \n    .card-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n    }\n    \n    .statistics-row {\n      display: flex;\n      justify-content: space-between;\n      flex-wrap: wrap;\n      gap: 10px;\n      \n      .stat-box {\n        padding: 10px 15px;\n        text-align: center;\n        flex: 1;\n        min-width: 100px;\n        \n        .stat-value {\n          font-size: 22px;\n          font-weight: bold;\n          color: #409EFF;\n          margin-bottom: 5px;\n        }\n        \n        .stat-label {\n          font-size: 14px;\n          color: #909399;\n        }\n      }\n    }\n  }\n  \n  .filter-card {\n    margin-bottom: 20px;\n  }\n  \n  .assignments-card {\n    .assignments-tip {\n      padding: 30px 0;\n    }\n    \n    .assignment-title {\n      display: flex;\n      align-items: center;\n    }\n    \n    .pagination-container {\n      display: flex;\n      justify-content: flex-end;\n      margin-top: 20px;\n    }\n  }\n  \n  .assignment-detail {\n    padding: 20px;\n    \n    .detail-row {\n      display: flex;\n      margin-bottom: 15px;\n      \n      .detail-label {\n        width: 100px;\n        color: #606266;\n        font-weight: 500;\n      }\n      \n      .detail-value {\n        flex: 1;\n        \n        &.description,\n        &.content,\n        &.comment {\n          padding: 10px;\n          background-color: #f9f9f9;\n          border-radius: 4px;\n          min-height: 40px;\n          white-space: pre-line;\n        }\n        \n        &.score {\n          font-weight: bold;\n          color: #E6A23C;\n        }\n        \n        .submit-time {\n          margin-left: 10px;\n          color: #909399;\n          font-size: 14px;\n        }\n      }\n    }\n    \n    .detail-actions {\n      display: flex;\n      justify-content: flex-end;\n      margin-top: 20px;\n    }\n  }\n  \n  .submission-form {\n    .assignment-info {\n      margin-bottom: 20px;\n      \n      h3 {\n        font-size: 16px;\n        font-weight: 500;\n        margin-bottom: 15px;\n        color: #303133;\n        border-bottom: 1px solid #EBEEF5;\n        padding-bottom: 10px;\n      }\n      \n      .info-row {\n        display: flex;\n        margin-bottom: 15px;\n        \n        .info-label {\n          width: 80px;\n          color: #606266;\n          font-weight: 500;\n        }\n        \n        .info-value {\n          flex: 1;\n          \n          &.description {\n            padding: 10px;\n            background-color: #f9f9f9;\n            border-radius: 4px;\n            max-height: 100px;\n            overflow-y: auto;\n            white-space: pre-line;\n          }\n        }\n      }\n    }\n    \n    .submission-section {\n      h3 {\n        font-size: 16px;\n        font-weight: 500;\n        margin-bottom: 15px;\n        color: #303133;\n        border-bottom: 1px solid #EBEEF5;\n        padding-bottom: 10px;\n      }\n      \n      .upload-area {\n        width: 100%;\n        border: 1px dashed #d9d9d9;\n        border-radius: 6px;\n        padding: 20px;\n        text-align: center;\n        \n        &:hover {\n          border-color: #409EFF;\n        }\n      }\n      \n      .submission-notice {\n        margin-top: 20px;\n      }\n    }\n  }\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}